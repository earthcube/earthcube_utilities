
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../summarize/" rel="prev"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.40" name="generator"/>
<title>Earthcube Utilites - Earthcube Utilities</title>
<link href="../../assets/stylesheets/main.8c3ca2c6.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../assets/_mkdocstrings.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#earthcube-utilities-code-documentation">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Earthcube Utilities" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Earthcube Utilities">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Earthcube Utilities
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Earthcube Utilites
            
          </span>
</div>
</div>
</div>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/earthcube/earthcube_utilities" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../notebook_proxy/">
        
  
    
  
  Notebook Proxy

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../">
          
  
  Earthcube Utilities

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="./">
          
  
  Code Reference

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Earthcube Utilities" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Earthcube Utilities">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    Earthcube Utilities
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/earthcube/earthcube_utilities" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../notebook_proxy/">
<span class="md-ellipsis">
    Notebook Proxy
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Earthcube Utilities
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Earthcube Utilities
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Documentation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../earthcube_utilities_scripts/">
<span class="md-ellipsis">
    Scripts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../reporting/">
<span class="md-ellipsis">
    Reporting
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../summarize/">
<span class="md-ellipsis">
    Summarize
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
<span class="md-ellipsis">
    Code Reference
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Earthcube Utilites
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Earthcube Utilites
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#code-documentation">
<span class="md-ellipsis">
      Code Documentation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec">
<span class="md-ellipsis">
      ec
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.bucketutil">
<span class="md-ellipsis">
      bucketutil
    </span>
</a>
<nav aria-label="bucketutil" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.bucketutil.EcConfig">
<span class="md-ellipsis">
      EcConfig
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.bucketutil.cullurls">
<span class="md-ellipsis">
      cullurls
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.bucketutil.download">
<span class="md-ellipsis">
      download
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.bucketutil.duplicateurls">
<span class="md-ellipsis">
      duplicateurls
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.bucketutil.sourceurl">
<span class="md-ellipsis">
      sourceurl
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.bucketutil.urls">
<span class="md-ellipsis">
      urls
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.collection">
<span class="md-ellipsis">
      collection
    </span>
</a>
<nav aria-label="collection" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.collection.rocrate_collection">
<span class="md-ellipsis">
      rocrate_collection
    </span>
</a>
<nav aria-label="rocrate_collection" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.collection.rocrate_collection.SosRocrate">
<span class="md-ellipsis">
      SosRocrate
    </span>
</a>
<nav aria-label="SosRocrate" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.collection.rocrate_collection.SosRocrate.addSosDatasetAsCtxEntity">
<span class="md-ellipsis">
      addSosDatasetAsCtxEntity
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore">
<span class="md-ellipsis">
      datastore
    </span>
</a>
<nav aria-label="datastore" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3">
<span class="md-ellipsis">
      s3
    </span>
</a>
<nav aria-label="s3" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.MinioDatastore">
<span class="md-ellipsis">
      MinioDatastore
    </span>
</a>
<nav aria-label="MinioDatastore" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.MinioDatastore.__init__">
<span class="md-ellipsis">
      __init__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.MinioDatastore.getFileFromStore">
<span class="md-ellipsis">
      getFileFromStore
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.MinioDatastore.getFileMetadataFromStore">
<span class="md-ellipsis">
      getFileMetadataFromStore
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.MinioDatastore.listPath">
<span class="md-ellipsis">
      listPath
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.bucketDatastore">
<span class="md-ellipsis">
      bucketDatastore
    </span>
</a>
<nav aria-label="bucketDatastore" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.bucketDatastore.copyObject">
<span class="md-ellipsis">
      copyObject
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.bucketDatastore.listJsonld">
<span class="md-ellipsis">
      listJsonld
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.bucketDatastore.listReportFile">
<span class="md-ellipsis">
      listReportFile
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.bucketDatastore.listSummonedSha">
<span class="md-ellipsis">
      listSummonedSha
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.bucketDatastore.listSummonedUrls">
<span class="md-ellipsis">
      listSummonedUrls
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.ec_reports">
<span class="md-ellipsis">
      ec_reports
    </span>
</a>
<nav aria-label="ec_reports" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.ec_reports.EcConfig">
<span class="md-ellipsis">
      EcConfig
    </span>
</a>
<nav aria-label="EcConfig" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.ec_reports.EcConfig.hasGraphendpoint">
<span class="md-ellipsis">
      hasGraphendpoint
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.gleanerio">
<span class="md-ellipsis">
      gleanerio
    </span>
</a>
<nav aria-label="gleanerio" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.gleanerio.gleaner">
<span class="md-ellipsis">
      gleaner
    </span>
</a>
<nav aria-label="gleaner" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.gleanerio.gleaner.getGleanerFromFile">
<span class="md-ellipsis">
      getGleanerFromFile
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.gleanerio.gleaner.getNabuFromFile">
<span class="md-ellipsis">
      getNabuFromFile
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph">
<span class="md-ellipsis">
      graph
    </span>
</a>
<nav aria-label="graph" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph">
<span class="md-ellipsis">
      manageGraph
    </span>
</a>
<nav aria-label="manageGraph" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageBlazegraph">
<span class="md-ellipsis">
      ManageBlazegraph
    </span>
</a>
<nav aria-label="ManageBlazegraph" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageBlazegraph.createNamespace">
<span class="md-ellipsis">
      createNamespace
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageBlazegraph.deleteNamespace">
<span class="md-ellipsis">
      deleteNamespace
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageBlazegraph.insert">
<span class="md-ellipsis">
      insert
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageBlazegraph.upload_file">
<span class="md-ellipsis">
      upload_file
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageBlazegraph.upload_nq_file">
<span class="md-ellipsis">
      upload_nq_file
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageBlazegraph.upload_ttl_file">
<span class="md-ellipsis">
      upload_ttl_file
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageGraph">
<span class="md-ellipsis">
      ManageGraph
    </span>
</a>
<nav aria-label="ManageGraph" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageGraph.__init__">
<span class="md-ellipsis">
      __init__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageGraph.createNamespace">
<span class="md-ellipsis">
      createNamespace
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageGraph.deleteNamespace">
<span class="md-ellipsis">
      deleteNamespace
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.sparql_query">
<span class="md-ellipsis">
      sparql_query
    </span>
</a>
<nav aria-label="sparql_query" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.sparql_query._getSparqlFileFromResources">
<span class="md-ellipsis">
      _getSparqlFileFromResources
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.sparql_query.getAGraph">
<span class="md-ellipsis">
      getAGraph
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.sparql_query.listSparqlFilesFromResources">
<span class="md-ellipsis">
      listSparqlFilesFromResources
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.sparql_query.queryWithSparql">
<span class="md-ellipsis">
      queryWithSparql
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.logger">
<span class="md-ellipsis">
      logger
    </span>
</a>
<nav aria-label="logger" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.logger.log">
<span class="md-ellipsis">
      log
    </span>
</a>
<nav aria-label="log" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.logger.log.config_app">
<span class="md-ellipsis">
      config_app
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.logger.log.config_notebook">
<span class="md-ellipsis">
      config_notebook
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.logger.log.config_web">
<span class="md-ellipsis">
      config_web
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.missing_report">
<span class="md-ellipsis">
      missing_report
    </span>
</a>
<nav aria-label="missing_report" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.missing_report.start">
<span class="md-ellipsis">
      start
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook">
<span class="md-ellipsis">
      notebook
    </span>
</a>
<nav aria-label="notebook" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.get_from_geocodes">
<span class="md-ellipsis">
      get_from_geocodes
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.get_jsfile2dict">
<span class="md-ellipsis">
      get_jsfile2dict
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.get_txtfile">
<span class="md-ellipsis">
      get_txtfile
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.inCollab">
<span class="md-ellipsis">
      inCollab
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.put_txtfile">
<span class="md-ellipsis">
      put_txtfile
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.geocodes">
<span class="md-ellipsis">
      geocodes
    </span>
</a>
<nav aria-label="geocodes" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.geocodes.get_from_geocodes">
<span class="md-ellipsis">
      get_from_geocodes
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.utils">
<span class="md-ellipsis">
      utils
    </span>
</a>
<nav aria-label="utils" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.utils.get_jsfile2dict">
<span class="md-ellipsis">
      get_jsfile2dict
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.utils.get_txtfile">
<span class="md-ellipsis">
      get_txtfile
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.utils.inCollab">
<span class="md-ellipsis">
      inCollab
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.utils.put_txtfile">
<span class="md-ellipsis">
      put_txtfile
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.reporting">
<span class="md-ellipsis">
      reporting
    </span>
</a>
<nav aria-label="reporting" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.reporting.report">
<span class="md-ellipsis">
      report
    </span>
</a>
<nav aria-label="report" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.reporting.report.compareSummoned2Graph">
<span class="md-ellipsis">
      compareSummoned2Graph
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.reporting.report.compareSummoned2Milled">
<span class="md-ellipsis">
      compareSummoned2Milled
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.reporting.report.getGraphReportsLatestRepoReports">
<span class="md-ellipsis">
      getGraphReportsLatestRepoReports
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.reporting.report.get_url_from_sha_list">
<span class="md-ellipsis">
      get_url_from_sha_list
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.reporting.report.listGraphReportDates4Repo">
<span class="md-ellipsis">
      listGraphReportDates4Repo
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap">
<span class="md-ellipsis">
      sitemap
    </span>
</a>
<nav aria-label="sitemap" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap">
<span class="md-ellipsis">
      sitemap
    </span>
</a>
<nav aria-label="sitemap" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap.GleanerioSourceSitemap">
<span class="md-ellipsis">
      GleanerioSourceSitemap
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap.Sitemap">
<span class="md-ellipsis">
      Sitemap
    </span>
</a>
<nav aria-label="Sitemap" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap.Sitemap.get_url_report">
<span class="md-ellipsis">
      get_url_report
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap.Sitemap.uniqueItems">
<span class="md-ellipsis">
      uniqueItems
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap.Sitemap.uniqueUrls">
<span class="md-ellipsis">
      uniqueUrls
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap.Sitemap.validUrl">
<span class="md-ellipsis">
      validUrl
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap._urlResponse">
<span class="md-ellipsis">
      _urlResponse
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json">
<span class="md-ellipsis">
      sos_json
    </span>
</a>
<nav aria-label="sos_json" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.rdf">
<span class="md-ellipsis">
      rdf
    </span>
</a>
<nav aria-label="rdf" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.rdf.createRDFNode">
<span class="md-ellipsis">
      createRDFNode
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.rdf.df2rdfgraph">
<span class="md-ellipsis">
      df2rdfgraph
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.rdf.get_graph2jsonld">
<span class="md-ellipsis">
      get_graph2jsonld
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.rdf.get_rdf2jld_str">
<span class="md-ellipsis">
      get_rdf2jld_str
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.rdf.graph2jsonld">
<span class="md-ellipsis">
      graph2jsonld
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.rdf.load_release">
<span class="md-ellipsis">
      load_release
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils">
<span class="md-ellipsis">
      utils
    </span>
</a>
<nav aria-label="utils" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils._getSchemaFromResources">
<span class="md-ellipsis">
      _getSchemaFromResources
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils.compact_jld_str">
<span class="md-ellipsis">
      compact_jld_str
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils.formatted_jsonld">
<span class="md-ellipsis">
      formatted_jsonld
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils.isValidJSON">
<span class="md-ellipsis">
      isValidJSON
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils.listSchemaFilesFromResources">
<span class="md-ellipsis">
      listSchemaFilesFromResources
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils.validateEcrrTool">
<span class="md-ellipsis">
      validateEcrrTool
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils.validateJson2Schema">
<span class="md-ellipsis">
      validateJson2Schema
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils.validateSosDataset">
<span class="md-ellipsis">
      validateSosDataset
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize">
<span class="md-ellipsis">
      summarize
    </span>
</a>
<nav aria-label="summarize" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize.summarize_materializedview">
<span class="md-ellipsis">
      summarize_materializedview
    </span>
</a>
<nav aria-label="summarize_materializedview" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize.summarize_materializedview.context">
<span class="md-ellipsis">
      context
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize.summarize_materializedview.summaryDF2ttl">
<span class="md-ellipsis">
      summaryDF2ttl
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize_from_graph_namespace">
<span class="md-ellipsis">
      summarize_from_graph_namespace
    </span>
</a>
<nav aria-label="summarize_from_graph_namespace" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize_from_graph_namespace.summarizeGraphOnly">
<span class="md-ellipsis">
      summarizeGraphOnly
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize_identifier_metadata">
<span class="md-ellipsis">
      summarize_identifier_metadata
    </span>
</a>
<nav aria-label="summarize_identifier_metadata" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize_identifier_metadata.start">
<span class="md-ellipsis">
      start
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize_repo">
<span class="md-ellipsis">
      summarize_repo
    </span>
</a>
<nav aria-label="summarize_repo" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize_repo.summarizeRepo">
<span class="md-ellipsis">
      summarizeRepo
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#code-documentation">
<span class="md-ellipsis">
      Code Documentation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec">
<span class="md-ellipsis">
      ec
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.bucketutil">
<span class="md-ellipsis">
      bucketutil
    </span>
</a>
<nav aria-label="bucketutil" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.bucketutil.EcConfig">
<span class="md-ellipsis">
      EcConfig
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.bucketutil.cullurls">
<span class="md-ellipsis">
      cullurls
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.bucketutil.download">
<span class="md-ellipsis">
      download
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.bucketutil.duplicateurls">
<span class="md-ellipsis">
      duplicateurls
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.bucketutil.sourceurl">
<span class="md-ellipsis">
      sourceurl
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.bucketutil.urls">
<span class="md-ellipsis">
      urls
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.collection">
<span class="md-ellipsis">
      collection
    </span>
</a>
<nav aria-label="collection" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.collection.rocrate_collection">
<span class="md-ellipsis">
      rocrate_collection
    </span>
</a>
<nav aria-label="rocrate_collection" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.collection.rocrate_collection.SosRocrate">
<span class="md-ellipsis">
      SosRocrate
    </span>
</a>
<nav aria-label="SosRocrate" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.collection.rocrate_collection.SosRocrate.addSosDatasetAsCtxEntity">
<span class="md-ellipsis">
      addSosDatasetAsCtxEntity
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore">
<span class="md-ellipsis">
      datastore
    </span>
</a>
<nav aria-label="datastore" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3">
<span class="md-ellipsis">
      s3
    </span>
</a>
<nav aria-label="s3" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.MinioDatastore">
<span class="md-ellipsis">
      MinioDatastore
    </span>
</a>
<nav aria-label="MinioDatastore" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.MinioDatastore.__init__">
<span class="md-ellipsis">
      __init__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.MinioDatastore.getFileFromStore">
<span class="md-ellipsis">
      getFileFromStore
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.MinioDatastore.getFileMetadataFromStore">
<span class="md-ellipsis">
      getFileMetadataFromStore
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.MinioDatastore.listPath">
<span class="md-ellipsis">
      listPath
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.bucketDatastore">
<span class="md-ellipsis">
      bucketDatastore
    </span>
</a>
<nav aria-label="bucketDatastore" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.bucketDatastore.copyObject">
<span class="md-ellipsis">
      copyObject
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.bucketDatastore.listJsonld">
<span class="md-ellipsis">
      listJsonld
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.bucketDatastore.listReportFile">
<span class="md-ellipsis">
      listReportFile
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.bucketDatastore.listSummonedSha">
<span class="md-ellipsis">
      listSummonedSha
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.datastore.s3.bucketDatastore.listSummonedUrls">
<span class="md-ellipsis">
      listSummonedUrls
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.ec_reports">
<span class="md-ellipsis">
      ec_reports
    </span>
</a>
<nav aria-label="ec_reports" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.ec_reports.EcConfig">
<span class="md-ellipsis">
      EcConfig
    </span>
</a>
<nav aria-label="EcConfig" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.ec_reports.EcConfig.hasGraphendpoint">
<span class="md-ellipsis">
      hasGraphendpoint
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.gleanerio">
<span class="md-ellipsis">
      gleanerio
    </span>
</a>
<nav aria-label="gleanerio" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.gleanerio.gleaner">
<span class="md-ellipsis">
      gleaner
    </span>
</a>
<nav aria-label="gleaner" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.gleanerio.gleaner.getGleanerFromFile">
<span class="md-ellipsis">
      getGleanerFromFile
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.gleanerio.gleaner.getNabuFromFile">
<span class="md-ellipsis">
      getNabuFromFile
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph">
<span class="md-ellipsis">
      graph
    </span>
</a>
<nav aria-label="graph" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph">
<span class="md-ellipsis">
      manageGraph
    </span>
</a>
<nav aria-label="manageGraph" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageBlazegraph">
<span class="md-ellipsis">
      ManageBlazegraph
    </span>
</a>
<nav aria-label="ManageBlazegraph" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageBlazegraph.createNamespace">
<span class="md-ellipsis">
      createNamespace
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageBlazegraph.deleteNamespace">
<span class="md-ellipsis">
      deleteNamespace
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageBlazegraph.insert">
<span class="md-ellipsis">
      insert
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageBlazegraph.upload_file">
<span class="md-ellipsis">
      upload_file
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageBlazegraph.upload_nq_file">
<span class="md-ellipsis">
      upload_nq_file
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageBlazegraph.upload_ttl_file">
<span class="md-ellipsis">
      upload_ttl_file
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageGraph">
<span class="md-ellipsis">
      ManageGraph
    </span>
</a>
<nav aria-label="ManageGraph" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageGraph.__init__">
<span class="md-ellipsis">
      __init__
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageGraph.createNamespace">
<span class="md-ellipsis">
      createNamespace
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.manageGraph.ManageGraph.deleteNamespace">
<span class="md-ellipsis">
      deleteNamespace
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.sparql_query">
<span class="md-ellipsis">
      sparql_query
    </span>
</a>
<nav aria-label="sparql_query" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.sparql_query._getSparqlFileFromResources">
<span class="md-ellipsis">
      _getSparqlFileFromResources
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.sparql_query.getAGraph">
<span class="md-ellipsis">
      getAGraph
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.sparql_query.listSparqlFilesFromResources">
<span class="md-ellipsis">
      listSparqlFilesFromResources
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.graph.sparql_query.queryWithSparql">
<span class="md-ellipsis">
      queryWithSparql
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.logger">
<span class="md-ellipsis">
      logger
    </span>
</a>
<nav aria-label="logger" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.logger.log">
<span class="md-ellipsis">
      log
    </span>
</a>
<nav aria-label="log" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.logger.log.config_app">
<span class="md-ellipsis">
      config_app
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.logger.log.config_notebook">
<span class="md-ellipsis">
      config_notebook
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.logger.log.config_web">
<span class="md-ellipsis">
      config_web
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.missing_report">
<span class="md-ellipsis">
      missing_report
    </span>
</a>
<nav aria-label="missing_report" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.missing_report.start">
<span class="md-ellipsis">
      start
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook">
<span class="md-ellipsis">
      notebook
    </span>
</a>
<nav aria-label="notebook" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.get_from_geocodes">
<span class="md-ellipsis">
      get_from_geocodes
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.get_jsfile2dict">
<span class="md-ellipsis">
      get_jsfile2dict
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.get_txtfile">
<span class="md-ellipsis">
      get_txtfile
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.inCollab">
<span class="md-ellipsis">
      inCollab
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.put_txtfile">
<span class="md-ellipsis">
      put_txtfile
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.geocodes">
<span class="md-ellipsis">
      geocodes
    </span>
</a>
<nav aria-label="geocodes" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.geocodes.get_from_geocodes">
<span class="md-ellipsis">
      get_from_geocodes
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.utils">
<span class="md-ellipsis">
      utils
    </span>
</a>
<nav aria-label="utils" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.utils.get_jsfile2dict">
<span class="md-ellipsis">
      get_jsfile2dict
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.utils.get_txtfile">
<span class="md-ellipsis">
      get_txtfile
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.utils.inCollab">
<span class="md-ellipsis">
      inCollab
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.notebook.utils.put_txtfile">
<span class="md-ellipsis">
      put_txtfile
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.reporting">
<span class="md-ellipsis">
      reporting
    </span>
</a>
<nav aria-label="reporting" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.reporting.report">
<span class="md-ellipsis">
      report
    </span>
</a>
<nav aria-label="report" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.reporting.report.compareSummoned2Graph">
<span class="md-ellipsis">
      compareSummoned2Graph
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.reporting.report.compareSummoned2Milled">
<span class="md-ellipsis">
      compareSummoned2Milled
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.reporting.report.getGraphReportsLatestRepoReports">
<span class="md-ellipsis">
      getGraphReportsLatestRepoReports
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.reporting.report.get_url_from_sha_list">
<span class="md-ellipsis">
      get_url_from_sha_list
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.reporting.report.listGraphReportDates4Repo">
<span class="md-ellipsis">
      listGraphReportDates4Repo
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap">
<span class="md-ellipsis">
      sitemap
    </span>
</a>
<nav aria-label="sitemap" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap">
<span class="md-ellipsis">
      sitemap
    </span>
</a>
<nav aria-label="sitemap" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap.GleanerioSourceSitemap">
<span class="md-ellipsis">
      GleanerioSourceSitemap
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap.Sitemap">
<span class="md-ellipsis">
      Sitemap
    </span>
</a>
<nav aria-label="Sitemap" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap.Sitemap.get_url_report">
<span class="md-ellipsis">
      get_url_report
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap.Sitemap.uniqueItems">
<span class="md-ellipsis">
      uniqueItems
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap.Sitemap.uniqueUrls">
<span class="md-ellipsis">
      uniqueUrls
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap.Sitemap.validUrl">
<span class="md-ellipsis">
      validUrl
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sitemap.sitemap._urlResponse">
<span class="md-ellipsis">
      _urlResponse
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json">
<span class="md-ellipsis">
      sos_json
    </span>
</a>
<nav aria-label="sos_json" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.rdf">
<span class="md-ellipsis">
      rdf
    </span>
</a>
<nav aria-label="rdf" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.rdf.createRDFNode">
<span class="md-ellipsis">
      createRDFNode
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.rdf.df2rdfgraph">
<span class="md-ellipsis">
      df2rdfgraph
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.rdf.get_graph2jsonld">
<span class="md-ellipsis">
      get_graph2jsonld
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.rdf.get_rdf2jld_str">
<span class="md-ellipsis">
      get_rdf2jld_str
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.rdf.graph2jsonld">
<span class="md-ellipsis">
      graph2jsonld
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.rdf.load_release">
<span class="md-ellipsis">
      load_release
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils">
<span class="md-ellipsis">
      utils
    </span>
</a>
<nav aria-label="utils" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils._getSchemaFromResources">
<span class="md-ellipsis">
      _getSchemaFromResources
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils.compact_jld_str">
<span class="md-ellipsis">
      compact_jld_str
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils.formatted_jsonld">
<span class="md-ellipsis">
      formatted_jsonld
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils.isValidJSON">
<span class="md-ellipsis">
      isValidJSON
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils.listSchemaFilesFromResources">
<span class="md-ellipsis">
      listSchemaFilesFromResources
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils.validateEcrrTool">
<span class="md-ellipsis">
      validateEcrrTool
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils.validateJson2Schema">
<span class="md-ellipsis">
      validateJson2Schema
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.sos_json.utils.validateSosDataset">
<span class="md-ellipsis">
      validateSosDataset
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize">
<span class="md-ellipsis">
      summarize
    </span>
</a>
<nav aria-label="summarize" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize.summarize_materializedview">
<span class="md-ellipsis">
      summarize_materializedview
    </span>
</a>
<nav aria-label="summarize_materializedview" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize.summarize_materializedview.context">
<span class="md-ellipsis">
      context
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize.summarize_materializedview.summaryDF2ttl">
<span class="md-ellipsis">
      summaryDF2ttl
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize_from_graph_namespace">
<span class="md-ellipsis">
      summarize_from_graph_namespace
    </span>
</a>
<nav aria-label="summarize_from_graph_namespace" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize_from_graph_namespace.summarizeGraphOnly">
<span class="md-ellipsis">
      summarizeGraphOnly
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize_identifier_metadata">
<span class="md-ellipsis">
      summarize_identifier_metadata
    </span>
</a>
<nav aria-label="summarize_identifier_metadata" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize_identifier_metadata.start">
<span class="md-ellipsis">
      start
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize_repo">
<span class="md-ellipsis">
      summarize_repo
    </span>
</a>
<nav aria-label="summarize_repo" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ec.summarize_repo.summarizeRepo">
<span class="md-ellipsis">
      summarizeRepo
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/earthcube/earthcube_utilities/edit/docs/docs/earthcube_utilities/earthcube_utilities_code.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg>
</a>
<a class="md-content__button md-icon" href="https://github.com/earthcube/earthcube_utilities/raw/docs/docs/earthcube_utilities/earthcube_utilities_code.md" title="View source of this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"></path></svg>
</a>
<h1 id="earthcube-utilities-code-documentation">Earthcube Utilities Code Documentation<a class="headerlink" href="#earthcube-utilities-code-documentation" title="Permanent link"></a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>this does not work with multirepo plug, so will need ot be linked </p>
</div>
<h2 id="code-documentation">Code Documentation<a class="headerlink" href="#code-documentation" title="Permanent link"></a></h2>
<div class="doc doc-object doc-module">
<a id="ec"></a>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.bucketutil">
<code>bucketutil</code>
<a class="headerlink" href="#ec.bucketutil" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="ec.bucketutil.EcConfig">
<code>EcConfig</code>
<a class="headerlink" href="#ec.bucketutil.EcConfig" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p class="doc doc-class-bases">
              Bases: <code>object</code></p>
<p>Parameters that might be common to commands</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/bucketutil.py</code></summary>
<pre class="highlight"><code class="language-python">class EcConfig(object):
    """ Parameters that might be common to commands"""
    def __init__(self, cfgfile=None, s3server=None, s3bucket=None, upload=None, output=None,debug=False):
        if cfgfile:
            s3endpoint, bucket, glnr = getGleaner(cfgfile)
            minio = glnr.get("minio")
            # passed paramters override the config parameters
            self.s3server = s3server if s3server else s3endpoint
            self.bucket = s3bucket if s3bucket else bucket
            self.glnr = glnr
        else:
            self.s3server = s3server
            self.bucket = s3bucket
        self.output= output
        self.upload = upload
        self.debug = debug

    # lets put checks as methods in here.
    # that way some checks if we can connect can be done in one place
    def hasS3(self) -&gt; bool:
         if   ( is_empty(self.s3server) or is_empty(self.bucket) ):
             log.fatal(f" must provide a gleaner config or (s3endpoint and s3bucket)]")
             raise Exception("must provide a gleaner config or (s3endpoint and s3bucket)]")
         return True
    def hasS3Upload(self) -&gt; bool:
         if  not self.upload and ( is_empty(self.s3server) or is_empty(self.bucket) ):
             log.fatal(f" must provide a gleaner config or (s3endpoint and s3bucket)]")
             raise Exception("must provide a gleaner config or (s3endpoint and s3bucket)]")
         return True</code></pre>
</details>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ec.bucketutil.cullurls">
<code class="highlight language-python">cullurls(cfgfile, s3server, s3bucket, upload, output, debug, source)</code>
<a class="headerlink" href="#ec.bucketutil.cullurls" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>for a given url, find the sha of the file</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/bucketutil.py</code></summary>
<pre class="highlight"><code class="language-python">@cli.command()
@click.option('--source', help='One or more repositories (--source a --source b)', multiple=True)
@common_params
def cullurls(cfgfile, s3server, s3bucket, upload, output, debug, source):
    """ for a given url, find the sha of the file"""
    ctx = EcConfig(cfgfile, s3server, s3bucket, upload, output, debug)
    ctx.hasS3()
    s3Minio = s3.MinioDatastore(ctx.s3server, None)
    utc = pytz.UTC
    df = s3Minio.listDuplicateUrls(ctx.bucket, source)
    try:
        if len(df) &lt;= 0:
            logging.info(f"No object has been found")
            return

        df = df[df['Url Duplicates'] &gt; 1]
        if len(df) &lt;= 0:
            logging.info(f" Nothing to cull")
            return
        # delete duplicated objects that are older than 7 days ago
        df = df[df['Date'] &lt; utc.localize(datetime.datetime.now() - datetime.timedelta(days=7))]
        removeObjectList = df.get('Name').values.tolist()
        for r in removeObjectList:
            s3Minio.removeObject(ctx.bucket, str(r))
            logging.info('Removed object: ' + str(r))
    except Exception as e:
        logging.info(e)
    return</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ec.bucketutil.download">
<code class="highlight language-python">download(cfgfile, s3server, s3bucket, upload, output, debug, urn)</code>
<a class="headerlink" href="#ec.bucketutil.download" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>For a given URN(s), download the files and the Metadata</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/bucketutil.py</code></summary>
<pre class="highlight"><code class="language-python">@cli.command()
@click.option('--urn', help='One or more urns (--urn a --urn b)', multiple=True, required=True)
@common_params
def download(cfgfile, s3server, s3bucket, upload, output, debug, urn):
    """For a given URN(s), download the files and the Metadata"""
    ctx = EcConfig(cfgfile, s3server, s3bucket, upload, output, debug)
    s3Minio = s3.MinioDatastore(ctx.s3server, None)
    ctx.hasS3()

    for sha in urn:
        # need to parse the source and actual sha/id out of the urn
        # and then do the path and creat path
        parts = parts_from_urn(sha)
        mypath = parts.get('source')
        id = parts.get('id')
        if not os.path.isdir(mypath):
            os.makedirs(mypath)
        outFileName = f"{mypath}/{id}.jsonld"
        log.info(outFileName)
        outFile = open(outFileName, "wb")
        o = s3Minio.getJsonLD(ctx.bucket, mypath, id)
        outFile.write(o)
        outFile.close()
        outFileName = f"{mypath}/{id}.jsonld.meta.txt"
        log.info(outFileName)
        outFile = open(outFileName, "wb")
        o = s3Minio.getJsonLDMetadata(ctx.bucket, mypath, id)
        outFile.write( bytes(json.dumps(o), 'utf8'))
        outFile.close()
    return</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ec.bucketutil.duplicateurls">
<code class="highlight language-python">duplicateurls(cfgfile, s3server, s3bucket, upload, output, debug, source)</code>
<a class="headerlink" href="#ec.bucketutil.duplicateurls" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Find Possible Duplicates based on the URL that was used to summon JSONLD.
Note, the may be ok, if a given URL has more than one JSONLD in the HTML.</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/bucketutil.py</code></summary>
<pre class="highlight"><code class="language-python">@cli.command()
@click.option('--source', help='One or more repositories (--source a --source b)', multiple=True)
@common_params
def duplicateurls(cfgfile, s3server, s3bucket, upload, output, debug, source):
    """ Find Possible Duplicates based on the URL that was used to summon JSONLD.
    Note, the may be ok, if a given URL has more than one JSONLD in the HTML.
    """
    ctx = EcConfig(cfgfile, s3server, s3bucket, upload, output, debug)
    ctx.hasS3()
    s3Minio = s3.MinioDatastore(ctx.s3server, None)
    df = s3Minio.listDuplicateUrls(ctx.bucket, source)
    try:
        if len(df) &lt;= 0:
            logging.info(f"No object has been found")
            return

        df = df[df['Url Duplicates'] &gt; 1]
        if len(df) &lt;= 0:
            logging.info(f"No duplicate has been found")
            return

        df['Example'] = df.apply(lambda f: f['Name'] + ', ' + str(f['Date']), axis=1)
        df = df.groupby(['Source', 'Url'], group_keys=True, dropna=False) \
            .agg({'Name': 'count', 'Example': lambda x: x.iloc[0:5].tolist()}).reset_index()
        df = df.rename(columns={'Name': 'Duplicates'})

        res = df.to_csv(index=False)
        sys.stdout.write(res)
        if output:
            output.write(bytes(res, 'utf-8'))
        if upload:
            s3Minio.putReportFile(ctx.bucket, "all", "bucketutil_dupliactes.csv", res)
    except Exception as e:
        logging.info(e)
    return 0</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ec.bucketutil.sourceurl">
<code class="highlight language-python">sourceurl(cfgfile, s3server, s3bucket, upload, output, debug, url, summon, milled)</code>
<a class="headerlink" href="#ec.bucketutil.sourceurl" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>for a given url, find the sha of the file</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/bucketutil.py</code></summary>
<pre class="highlight"><code class="language-python">@cli.command()
@click.option('--url', help='the X-Amz-Meta-Url in metadata', required=True)
@click.option('--milled', help='include milled', default=False)
@click.option('--summoned', help='include summon only', default=True)
@common_params
def sourceurl(cfgfile, s3server, s3bucket, upload, output, debug, url, summon, milled):
    """ for a given url, find the sha of the file"""
    ctx = EcConfig(cfgfile, s3server, s3bucket, upload, output, debug)
    ctx.hasS3()
    s3Minio = s3.MinioDatastore(ctx.s3server, None)
    paths = list()
    o_list = list()
    if summon:
        paths = list(s3Minio.listPath(ctx.bucket, 'summoned/', recursive=False))
    if milled:
        paths.extend(list(s3Minio.listPath(ctx.bucket, 'milled/', recursive=False)))
    for path in paths:
        try:
            jsonlds = s3Minio.listPath(ctx.bucket, path.object_name, include_user_meta=True)
            objs = map(lambda f: s3Minio.s3client.stat_object(f.bucket_name, f.object_name), jsonlds)
            o_list.extend(list(filter(lambda f: f.metadata.get('X-Amz-Meta-Url') == url, objs)))
        except Exception as e:
            logging.error(e)

    if len(o_list)&gt;0:
        for o in o_list:
            outFileName = f"{o.metadata.get('X-Amz-Meta-Uniqueid')}.jsonld"
            log.info(outFileName)
            outFile = open(outFileName, "wb")
            s3ObjectInfo = {"bucket_name": ctx.bucket, "object_name": o.object_name}
            resp = s3Minio.getFileFromStore(s3ObjectInfo)
            outFile.write(resp)
            outFile.close()
            outFileName = f"{o.metadata.get('X-Amz-Meta-Uniqueid')}.jsonld.meta.txt"
            log.info(outFileName)
            outFile = open(outFileName, "wb")
            s3ObjectInfo = {"bucket_name": ctx.bucket, "object_name": o.object_name}
            tags = s3Minio.getFileMetadataFromStore(s3ObjectInfo)
            outFile.write(bytes(json.dumps(tags, indent=4), 'utf8'))
            outFile.close()
    else:
        log.info(f"Nothing has been found for url: ", url)
    return</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ec.bucketutil.urls">
<code class="highlight language-python">urls(cfgfile, s3server, s3bucket, upload, output, debug, source)</code>
<a class="headerlink" href="#ec.bucketutil.urls" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Retreive the URL harvested for a give bucket. T
There may be duplicate URL's, if an HTML has more than one JSONLD</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/bucketutil.py</code></summary>
<pre class="highlight"><code class="language-python">@cli.command()
@click.option('--source', help='A repository', required=True)
@common_params
def urls(cfgfile, s3server, s3bucket, upload, output, debug, source):
    """Retreive the URL harvested for a give bucket. T
    There may be duplicate URL's, if an HTML has more than one JSONLD"""
    ctx = EcConfig(cfgfile, s3server, s3bucket, upload, output, debug)
    s3Minio = s3.MinioDatastore(ctx.s3server, None)
    ctx.hasS3()

    res = s3Minio.listSummonedUrls(ctx.bucket, source)
    res = pd.DataFrame(res).to_csv(index=False, quoting=csv.QUOTE_NONNUMERIC)
    sys.stdout.write(res)
    if output:
        log.info(f"report for {source} appended to file")
        output.write(bytes(res, 'utf-8'))
    if upload:
        s3Minio.putReportFile(ctx.bucket, source, "bucketutil_urls.csv", res)
    return</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.collection">
<code>collection</code>
<a class="headerlink" href="#ec.collection" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="ec.collection.rocrate_collection">
<code>rocrate_collection</code>
<a class="headerlink" href="#ec.collection.rocrate_collection" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="ec.collection.rocrate_collection.SosRocrate">
<code>SosRocrate</code>
<a class="headerlink" href="#ec.collection.rocrate_collection.SosRocrate" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p class="doc doc-class-bases">
              Bases: <code><span title="rocrate.rocrate.ROCrate">ROCrate</span></code></p>
<p>Science on Schema(SOS) ROCrate Object.
ROCrate plus methods to easily add SOS information to an ROCrate</p>
<details class="use" open="">
<summary>USE</summary>
<p><a href="https://github.com/ResearchObject/ro-crate-py#consuming-an-ro-crate">Consuming an RO-Crate</a>:</p>
</details> <p>use SosRocrate instead of RoCrate</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/collection/rocrate_collection.py</code></summary>
<pre class="highlight"><code class="language-python">class SosRocrate(ROCrate):
    """ Science on Schema(SOS) ROCrate Object.
    ROCrate plus methods to easily add SOS information to an ROCrate

    USE:
     [Consuming an RO-Crate](https://github.com/ResearchObject/ro-crate-py#consuming-an-ro-crate):
    use SosRocrate instead of RoCrate

    """
    def nameCrate(self, aName):
        self.nameCrate(aName)

    # this is the creator of the crate, it should be a sos_person
    # probably not correct, but it's a start
    def addSosCreator(self, crate, username):
        properties = {"name": username}

        creator = Person(crate, identifier=_createIdentifier(username), properties=properties)
        self.creator=creator

    # we are  of the crate, it should be a sos_person
    # probably not correct, but it's a start
    def addSosPublisher(self, crate, identifier=None, name=None):
        properties = {"name": name}
        if identifier is None:
            identifier = name
        creator = Person(crate, identifier=_createIdentifier(identifier), properties=properties)
        self.publisher = creator

        # pption 1 it's a file




    def addSosDistribution(self, crate, dataset_jsonld, distribution_to_add=None, distType=DATASET__DATA_DOWNLOAD):
        aurl = dataset_jsonld.get('url')
        name = dataset_jsonld.get('name')
        if distribution_to_add is None:
            #kw = {"fetch_remote": fetch_remote, "validate_url": validate_url}
            kw = {"name": name}
            self.add_file(aurl, properties=kw)
        elif distType == DATASET__DATA_DOWNLOAD :
            pass
        elif distType == DATASET__DATASET:
            self.add_dataset(source=dataset_jsonld)

    def addSosServicesAsEntity(self,crate, url=None, name=None):
        kw = {"name": name}
        self.add_file(source=url, properties=kw)
        pass

    def addSosURL(self, url=None, name=None):
        properties = {"name":name}
        self.add_file(source=url, properties=properties)
        #self.add_file(url, identifier=CreateIdentifier(url), properties=kw)

# two possible ways to add the whole JSONLD.
    # 1. File: url plus the jsonld
    # 2. Dataset (aka directory): url to geocodes, plus jsonld

    # these need to check that these are datasets ;)
    def addSosDatasetAsFile(self, dataset_jsonld,  url):
        properties = dataset_jsonld
        self.add_file(source=url, properties=properties)
### humm https://github.com/ResearchObject/ro-crate-py#adding-entities-with-an-arbitrary-type
    def addSosDatasetAsDataset(self, dataset_jsonld, urn, distType=DATASET__DATASET):
        self.add_dataset(dest_path=urn, properties=dataset_jsonld)


    # this does not get added to hasParts... aka does not get Identifieed as a Dataset
    def addSosDatasetAsCtxEntity(self, dataset_jsonld, urn, distType=DATASET__DATASET):
        """Not useful. this does not get added to hasParts... aka does not get Identifieed as a Dataset """
        datasetCtxEntity =ContextEntity(self, identifier=urn, properties=dataset_jsonld)

        self.add(datasetCtxEntity)
    def addSosContact(self, sos_contact):
            pass</code></pre>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.collection.rocrate_collection.SosRocrate.addSosDatasetAsCtxEntity">
<code class="highlight language-python">addSosDatasetAsCtxEntity(dataset_jsonld, urn, distType=DATASET__DATASET)</code>
<a class="headerlink" href="#ec.collection.rocrate_collection.SosRocrate.addSosDatasetAsCtxEntity" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>Not useful. this does not get added to hasParts... aka does not get Identifieed as a Dataset</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/collection/rocrate_collection.py</code></summary>
<pre class="highlight"><code class="language-python">def addSosDatasetAsCtxEntity(self, dataset_jsonld, urn, distType=DATASET__DATASET):
    """Not useful. this does not get added to hasParts... aka does not get Identifieed as a Dataset """
    datasetCtxEntity =ContextEntity(self, identifier=urn, properties=dataset_jsonld)

    self.add(datasetCtxEntity)</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.datastore">
<code>datastore</code>
<a class="headerlink" href="#ec.datastore" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="ec.datastore.s3">
<code>s3</code>
<a class="headerlink" href="#ec.datastore.s3" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="ec.datastore.s3.MinioDatastore">
<code>MinioDatastore</code>
<a class="headerlink" href="#ec.datastore.s3.MinioDatastore" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ec.datastore.s3.bucketDatastore" href="#ec.datastore.s3.bucketDatastore">bucketDatastore</a></code></p>
<p>Instance of a minio datastore with utility methods to retreive information</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/datastore/s3.py</code></summary>
<pre class="highlight"><code class="language-python">class MinioDatastore(bucketDatastore):
    """ Instance of a minio datastore with utility methods to retreive information"""
    def __init__(self, s3endpoint, options={},default_bucket="gleaner"):
        """ Initilize with
        Parameters:
            s3endpoint: endpoint. If this is aws, include the region. eg s3.us-west-2.amazon....
            options: creditials, other parameters to pass to client
            default_bucket: 'gleaner'
            """
        self.endpoint = s3endpoint
        self.options = {} if options is None else options # old code has none...
        self.default_bucket= default_bucket
        logging.info(str(options))
        self.s3client  =minio.Minio(s3endpoint, **self.options ) # this will neeed to be fixed with authentication


    def listPath(self, bucket, path, include_user_meta=False, recursive=True):
        """ returns the filelist for a path with the starting path removed from the list"""
        resp = self.s3client.list_objects(bucket, path, include_user_meta=include_user_meta, recursive=recursive)
        # the returned list includes the path
        o_list = filter(lambda f: f.object_name != path, resp)
        return o_list

    def listDuplicateUrls(self, bucket, sources, include_user_meta=False, recursive=False):
        if is_empty(sources):
            raise Exception("must provide sources")

        sources_to_run = sources
        dfs = pandas.DataFrame()
        paths = list(self.listPath(bucket, "summoned/", include_user_meta=include_user_meta, recursive=recursive))
        for p in paths:
            if not find(sources_to_run, lambda x: f"{self.paths.get('summon')}/{x}/" == p.object_name):
                continue
            try:
                jsonlds = self.listPath(bucket, p.object_name)
                objs = map(lambda f: self.s3client.stat_object(f.bucket_name, f.object_name), jsonlds)
                o_list = list(map(lambda f: {'Source': p.object_name,
                                             'Url': f.metadata.get('X-Amz-Meta-Url'),
                                             'Name': f.object_name,
                                             'Date': f.last_modified,
                                             }, objs))
            except Exception as e:
                logging.error(e)
            df = pandas.DataFrame(o_list)
            df['Url Duplicates'] = df.groupby(['Source', 'Url'])['Name'].transform('count')
            dfs = pandas.concat([dfs, df])
        return dfs


    def countPath(self, bucket, path):
        count = len(list(self.listPath(bucket, path)))
        return count

    def getFileFromStore(self, s3ObjectInfo):
        """ get an s3 file from teh store
        Parameters:
          s3ObjectInfo: {"bucket_name":obj.bucket_name, "object_name":obj.object_name }

        """
        resp = self.s3client.get_object(s3ObjectInfo["bucket_name"], s3ObjectInfo["object_name"])
        return resp.data
    def DataframeFromPath(self, bucket, path, include_user_meta=False):
        pathFiles = list(self.listPath(bucket,path,include_user_meta=include_user_meta))

        objs = map(lambda f: self.s3client.stat_object(f.bucket_name, f.object_name), pathFiles)
        data = map(lambda f: { "metadata": f.metadata, "bucket_name":f.bucket_name, "object_name":f.object_name}, objs )
        # does not work... should, but does not
        # data = list(map(lambda f:
        #                 pick(f,  'bucket_name', 'object_name')
        #                 , objs ))

        df = pandas.DataFrame(data=data)
        return df

    def getFileMetadataFromStore(self, s3ObjectInfo):
        """ get metadata s3 file from teh store
               Parameters:
                 s3ObjectInfo: {"bucket_name":obj.bucket_name, "object_name":obj.object_name }

               """
        s3obj = self.s3client.stat_object(s3ObjectInfo.get('bucket_name'), s3ObjectInfo.get('object_name'))
        md = s3obj.metadata
        user_meta = list()
        for o in md:
            if o.startswith("X-Amz-Meta"):
               user_meta.append({"name": o, "value": md[o]})
        # this needs to return the metadata
        return user_meta

    def putReportFile(self, bucket, repo, filename, json_str, date="latest", copy_to_date=True):
        path = f"{self.paths['report']}/{repo}/{date}/{filename}"
        f = BytesIO()
        length = f.write(bytes(json_str, 'utf-8'))
        f.seek(0)
        resp = self.s3client.put_object(bucket, path, f,length=length)
        if copy_to_date:
            today_str = datetime.now().strftime("%Y%m%d")
            path = f"{self.paths['report']}/{repo}/{today_str}/{filename}"
            self.copyObject(resp,path)
        return resp.bucket_name, resp.object_name

    def getReportFile(self, bucket, repo, filename):
        path = f"{self.paths['report']}/{repo}/latest/{filename}"
        s3ObjectInfo = {"bucket_name": bucket, "object_name": path}
        resp = self.getFileFromStore(s3ObjectInfo)
        return resp

    def getLatestRelaseFile(self, bucket, repo):
        path = f"{self.paths['graph']}/latest/summonded{repo}_latest_release.nq"
        s3ObjectInfo = {"bucket_name":bucket,"object_name": path}
        resp = self.getFileFromStore(s3ObjectInfo)
        return resp

    def getRelasePaths(self, bucket):
        path = f"{self.paths['graph']}/latest/"
        files = self.listPath(bucket, path)
        paths = list(map(lambda f:  f.object_name, files))
        return paths

    def getRoCrateFile(self, filename, bucket="gleaner", user="public"):
        path = f"/{self.paths['collection']}/{user}/{filename}"
        crate = self.s3client.get_object(bucket, path)
        return crate

    def removeObject(self, bucket, path):
        self.s3client.remove_object(bucket, path)
        return</code></pre>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.datastore.s3.MinioDatastore.__init__">
<code class="highlight language-python">__init__(s3endpoint, options={}, default_bucket='gleaner')</code>
<a class="headerlink" href="#ec.datastore.s3.MinioDatastore.__init__" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>Initilize with
Parameters:
    s3endpoint: endpoint. If this is aws, include the region. eg s3.us-west-2.amazon....
    options: creditials, other parameters to pass to client
    default_bucket: 'gleaner'</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/datastore/s3.py</code></summary>
<pre class="highlight"><code class="language-python">def __init__(self, s3endpoint, options={},default_bucket="gleaner"):
    """ Initilize with
    Parameters:
        s3endpoint: endpoint. If this is aws, include the region. eg s3.us-west-2.amazon....
        options: creditials, other parameters to pass to client
        default_bucket: 'gleaner'
        """
    self.endpoint = s3endpoint
    self.options = {} if options is None else options # old code has none...
    self.default_bucket= default_bucket
    logging.info(str(options))
    self.s3client  =minio.Minio(s3endpoint, **self.options ) # this will neeed to be fixed with authentication</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.datastore.s3.MinioDatastore.getFileFromStore">
<code class="highlight language-python">getFileFromStore(s3ObjectInfo)</code>
<a class="headerlink" href="#ec.datastore.s3.MinioDatastore.getFileFromStore" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>get an s3 file from teh store
Parameters:
  s3ObjectInfo: {"bucket_name":obj.bucket_name, "object_name":obj.object_name }</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/datastore/s3.py</code></summary>
<pre class="highlight"><code class="language-python">def getFileFromStore(self, s3ObjectInfo):
    """ get an s3 file from teh store
    Parameters:
      s3ObjectInfo: {"bucket_name":obj.bucket_name, "object_name":obj.object_name }

    """
    resp = self.s3client.get_object(s3ObjectInfo["bucket_name"], s3ObjectInfo["object_name"])
    return resp.data</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.datastore.s3.MinioDatastore.getFileMetadataFromStore">
<code class="highlight language-python">getFileMetadataFromStore(s3ObjectInfo)</code>
<a class="headerlink" href="#ec.datastore.s3.MinioDatastore.getFileMetadataFromStore" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>get metadata s3 file from teh store
Parameters:
  s3ObjectInfo: {"bucket_name":obj.bucket_name, "object_name":obj.object_name }</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/datastore/s3.py</code></summary>
<pre class="highlight"><code class="language-python">def getFileMetadataFromStore(self, s3ObjectInfo):
    """ get metadata s3 file from teh store
           Parameters:
             s3ObjectInfo: {"bucket_name":obj.bucket_name, "object_name":obj.object_name }

           """
    s3obj = self.s3client.stat_object(s3ObjectInfo.get('bucket_name'), s3ObjectInfo.get('object_name'))
    md = s3obj.metadata
    user_meta = list()
    for o in md:
        if o.startswith("X-Amz-Meta"):
           user_meta.append({"name": o, "value": md[o]})
    # this needs to return the metadata
    return user_meta</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.datastore.s3.MinioDatastore.listPath">
<code class="highlight language-python">listPath(bucket, path, include_user_meta=False, recursive=True)</code>
<a class="headerlink" href="#ec.datastore.s3.MinioDatastore.listPath" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>returns the filelist for a path with the starting path removed from the list</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/datastore/s3.py</code></summary>
<pre class="highlight"><code class="language-python">def listPath(self, bucket, path, include_user_meta=False, recursive=True):
    """ returns the filelist for a path with the starting path removed from the list"""
    resp = self.s3client.list_objects(bucket, path, include_user_meta=include_user_meta, recursive=recursive)
    # the returned list includes the path
    o_list = filter(lambda f: f.object_name != path, resp)
    return o_list</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="ec.datastore.s3.bucketDatastore">
<code>bucketDatastore</code>
<a class="headerlink" href="#ec.datastore.s3.bucketDatastore" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/datastore/s3.py</code></summary>
<pre class="highlight"><code class="language-python">class bucketDatastore():
    endpoint = "http://localhost:9000" # basically minio
    options = {"secure":True,
               "region": 'us-west-2',
#               "access_key": None,
 #              "secret_key": None
               }
    default_bucket="gleaner"
    paths = {"report":"reports",
             "summon": "summoned",
             "milled":"milled",
             "graph":"graphs",
             "release":"graphs",
             "archive":"archive",
             "collection":"collections",
             "sitemap":"sitemaps"
    }

    def __init__(self, s3endpoint, options, default_bucket="gleaner"):
        self.endpoint = s3endpoint
        self.options = options
        self.default_bucket = default_bucket

    def listPath(self, bucket, path, include_user_meta=False):
        pass
    def countPath(self, bucket, path):
        count = len(list(self.listPath(bucket, path)))
        return count

    def DataframeFromPath(self, bucket, path, include_user_meta=False):
        pass
# who knows, we might implement on disk, or in a database. This just separates the data from the annotated metadata
    def getFileFromStore(self, s3ObjectInfo):
        pass
    def getFileMetadataFromStore(self, s3ObjectInfo):
        pass
    def putTextFileToStore(self,data, s3ObjectInfo ):
        f = BytesIO()
        length = f.write(bytes(data, 'utf-8'))
        f.seek(0)
        resp = self.s3client.put_object(s3ObjectInfo.bucket_name, s3ObjectInfo.object_name, f,length=length)
        return resp.bucket_name, resp.object_name
    def copyObject(self,s3ObjectInfoToCopy, ObjectPath ):
        ''' Server Side Copy, eg upload report to latest, make copy to today'''
        self.s3client.copy_object(
            s3ObjectInfoToCopy.bucket_name,
            ObjectPath,
            CopySource(s3ObjectInfoToCopy.bucket_name, s3ObjectInfoToCopy.object_name),
           # metadata=metadata,
            metadata_directive=REPLACE,
        )

    #### Methods for a getting information using infrastructure information

    """ Method for gleaner store"""
    def listJsonld(self,bucket, repo, include_user_meta=False):
        """ urllist returns list of urn;s with urls"""
        # include user meta not working.
        path = f"{self.paths['summon']}/{repo}/"
        return self.listPath(bucket, path,include_user_meta=include_user_meta)

    def countJsonld(self,bucket, repo) -&gt; int:
        count = len(list(self.listJsonld(bucket,repo)))
        return count

    def getJsonLD(self, bucket, repo, sha):
        path = f"{self.paths['summon']}/{repo}/{sha}.jsonld"
        s3ObjectInfo = {"bucket_name": bucket, "object_name": path}
        resp = self.getFileFromStore(s3ObjectInfo)
        return resp


    def listSummonedUrls(self,bucket, repo):
        """  returns list of urns with urls"""
        jsonlds = self.listJsonld(bucket, repo, include_user_meta=True)
        objs = map(lambda f: self.s3client.stat_object(f.bucket_name, f.object_name), jsonlds)
        o_list = list(map(lambda f: {"sha": shaFroms3Path(f.object_name),
                                     "url": f.metadata.get("X-Amz-Meta-Url"),
                                     "identifiertype": f.metadata.get("X-Amz-Meta-Identifiertype"),
                                     "lastmodified": f.last_modified
                                     }
                          , objs))
        return o_list

    def listSummonedSha(self,bucket, repo):
        """  returns list of urns with urls"""
        jsonlds = self.listJsonld(bucket, repo, include_user_meta=False)
        objs = map(lambda f: shaFroms3Path( f.object_name, extension=".jsonld"), jsonlds)
        # for ob in objs:
        #     print(ob)
        o_list = list(objs)
        return o_list

    def getJsonLDMetadata(self, bucket, repo, sha):
        path = f"{self.paths['summon']}/{repo}/{sha}.jsonld"
        s3ObjectInfo = {"bucket_name": bucket, "object_name": path}
        tags = self.getFileMetadataFromStore(s3ObjectInfo)

        return tags

    def getOringalUrl(self, bucket, repo, sha) -&gt; str:
        md = self.getJsonLDMetadata(bucket, repo, sha)
        return md['Url']

    '''Cleans the name of slashes... might need more in the future.'''
    def getCleanObjectName(s3ObjectName) -&gt; str:
        return s3ObjectName.replace('/','__')

    def listMilledRdf(self,bucket, repo,urnonly=False):
        path = f"{self.paths['milled']}/{repo}/"
        return self.listPath(bucket, path)
    def listMilledSha(self,bucket, repo,urnonly=False):
        paths = self.listMilledRdf(bucket,repo)
        shas = list(map(lambda p: shaFroms3Path(p.object_name, extension=".rdf"), paths))
        return shas

    def countMilledRdf(self,bucket, repo) -&gt; int:
        count = len(list(self.listMilledRdf(bucket,repo)))
        return count
    ### methods for reporting
    '''
    Reporting will have to pull the original and put back to the datastore
    '''

    def listReportFile(self,bucket, repo,include_user_meta=False):
        """ urllist returns list of urn;s with urls"""
        # include user meta not working.
        path = f"{self.paths['report']}/{repo}/"
        return self.listPath(bucket, path,include_user_meta=include_user_meta)

    def putReportFile(self, bucket, repo, filename, json_str,  date="latest", copy_to_date=True):

        pass

    def getReportFile(self, bucket, repo, filename):
        path = f"{self.paths['report']}/{repo}/filename"
        s3ObjectInfo = {"bucket_name": bucket, "object_name": path}
        resp = self.getFileFromStore(s3ObjectInfo)
        return resp

    def getLatestRelaseUrl(self, bucket, source, extension='nq'):
        urls = self.getLatestRelaseUrls(bucket)
        url = pydash.find( urls, lambda x: source in x.get("object_name") and "_release" in x.get("object_name")  and x.get("object_name").endswith(extension) )
        return url.get('url')

    def getLatestRelaseUrls(self, bucket):
        path = f"{self.paths['release']}/latest/"
        urls = self.listPath(bucket,path)
        urls = map(lambda f: { "object_name": f.object_name,
                               "url": f"https://{self.endpoint}/{f.bucket_name}/{f.object_name}" }, urls)
        return list(urls)
    def getLatestSummaryUrl(self, bucket, source, extension='ttl'):
        urls = self.getLatestRelaseUrls(bucket)
        url = pydash.find( urls, lambda x: source in x.get("object_name") and "_release" in x.get("object_name")  and x.get("object_name").endswith(extension) )
        return url.get('url')

    def getLatestSummaryUrls(self, bucket):
        path = f"{self.paths['release']}/summary/"
        urls = self.listPath(bucket,path)
        urls = map(lambda f: { "object_name": f.object_name,
                               "url": f"https://{self.endpoint}/{f.bucket_name}/{f.object_name}" }, urls)
        return list(urls)

    def getRoCrateFile(self, filename, bucket="gleaner", user="public"):
        path = f"{self.paths['crate']}/{user}/{filename}"
        s3ObjectInfo = {"bucket_name": bucket, "object_name": path}
        resp = self.getFileFromStore(s3ObjectInfo)
        return resp

    def putRoCrateFile(self, data: str,filename, bucket="gleaner", user="public"):
        path = f"{self.paths['report']}/{user}/{filename}"
        s3ObjectInfo = {"bucket_name": bucket, "object_name": path}
        return self.putTextFileToStore(data, s3ObjectInfo)

    def getSitemapFile(self,bucket, repo, filename):
        path = f"{self.paths['sitemap']}/{repo}/filename"
        s3ObjectInfo = {"bucket_name": bucket, "object_name": path}
        resp = self.getFileFromStore(s3ObjectInfo)
        return resp

    def putSitemapFile(self,data: str, repo: str,filename: str, bucket="gleaner"):
        path = f"{self.paths['sitemap']}/{repo}/{filename}"
        s3ObjectInfo = {"bucket_name": bucket, "object_name": path}
        return self.putTextFileToStore(data, s3ObjectInfo)</code></pre>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.datastore.s3.bucketDatastore.copyObject">
<code class="highlight language-python">copyObject(s3ObjectInfoToCopy, ObjectPath)</code>
<a class="headerlink" href="#ec.datastore.s3.bucketDatastore.copyObject" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>Server Side Copy, eg upload report to latest, make copy to today</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/datastore/s3.py</code></summary>
<pre class="highlight"><code class="language-python">def copyObject(self,s3ObjectInfoToCopy, ObjectPath ):
    ''' Server Side Copy, eg upload report to latest, make copy to today'''
    self.s3client.copy_object(
        s3ObjectInfoToCopy.bucket_name,
        ObjectPath,
        CopySource(s3ObjectInfoToCopy.bucket_name, s3ObjectInfoToCopy.object_name),
       # metadata=metadata,
        metadata_directive=REPLACE,
    )</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.datastore.s3.bucketDatastore.listJsonld">
<code class="highlight language-python">listJsonld(bucket, repo, include_user_meta=False)</code>
<a class="headerlink" href="#ec.datastore.s3.bucketDatastore.listJsonld" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>urllist returns list of urn;s with urls</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/datastore/s3.py</code></summary>
<pre class="highlight"><code class="language-python">def listJsonld(self,bucket, repo, include_user_meta=False):
    """ urllist returns list of urn;s with urls"""
    # include user meta not working.
    path = f"{self.paths['summon']}/{repo}/"
    return self.listPath(bucket, path,include_user_meta=include_user_meta)</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.datastore.s3.bucketDatastore.listReportFile">
<code class="highlight language-python">listReportFile(bucket, repo, include_user_meta=False)</code>
<a class="headerlink" href="#ec.datastore.s3.bucketDatastore.listReportFile" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>urllist returns list of urn;s with urls</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/datastore/s3.py</code></summary>
<pre class="highlight"><code class="language-python">def listReportFile(self,bucket, repo,include_user_meta=False):
    """ urllist returns list of urn;s with urls"""
    # include user meta not working.
    path = f"{self.paths['report']}/{repo}/"
    return self.listPath(bucket, path,include_user_meta=include_user_meta)</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.datastore.s3.bucketDatastore.listSummonedSha">
<code class="highlight language-python">listSummonedSha(bucket, repo)</code>
<a class="headerlink" href="#ec.datastore.s3.bucketDatastore.listSummonedSha" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>returns list of urns with urls</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/datastore/s3.py</code></summary>
<pre class="highlight"><code class="language-python">def listSummonedSha(self,bucket, repo):
    """  returns list of urns with urls"""
    jsonlds = self.listJsonld(bucket, repo, include_user_meta=False)
    objs = map(lambda f: shaFroms3Path( f.object_name, extension=".jsonld"), jsonlds)
    # for ob in objs:
    #     print(ob)
    o_list = list(objs)
    return o_list</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.datastore.s3.bucketDatastore.listSummonedUrls">
<code class="highlight language-python">listSummonedUrls(bucket, repo)</code>
<a class="headerlink" href="#ec.datastore.s3.bucketDatastore.listSummonedUrls" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>returns list of urns with urls</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/datastore/s3.py</code></summary>
<pre class="highlight"><code class="language-python">def listSummonedUrls(self,bucket, repo):
    """  returns list of urns with urls"""
    jsonlds = self.listJsonld(bucket, repo, include_user_meta=True)
    objs = map(lambda f: self.s3client.stat_object(f.bucket_name, f.object_name), jsonlds)
    o_list = list(map(lambda f: {"sha": shaFroms3Path(f.object_name),
                                 "url": f.metadata.get("X-Amz-Meta-Url"),
                                 "identifiertype": f.metadata.get("X-Amz-Meta-Identifiertype"),
                                 "lastmodified": f.last_modified
                                 }
                      , objs))
    return o_list</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.ec_reports">
<code>ec_reports</code>
<a class="headerlink" href="#ec.ec_reports" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h3 class="doc doc-heading" id="ec.ec_reports.EcConfig">
<code>EcConfig</code>
<a class="headerlink" href="#ec.ec_reports.EcConfig" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p class="doc doc-class-bases">
              Bases: <code>object</code></p>
<p>Parameters that might be common to commands</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/ec_reports.py</code></summary>
<pre class="highlight"><code class="language-python">class EcConfig(object):
    """ Parameters that might be common to commands"""
    def __init__(self, cfgfile=None, s3server=None, s3bucket=None, graphendpoint=None, upload=None, output=None,debug=False):
        if cfgfile:
            s3endpoint, bucket, glnr = getGleaner(cfgfile)
            minio = glnr.get("minio")
            # passed paramters override the config parameters
            self.s3server = s3server if s3server else s3endpoint
            self.bucket = s3bucket if s3bucket else bucket
        else:
            self.s3server = s3server
            self.bucket = s3bucket
        self.graphendpoint = graphendpoint
        self.output = output
        self.upload = upload
        self.debug = debug

    # lets put checks as methods in here.
    # that way some checks if we can connect can be done in one place
    def hasS3(self) -&gt; bool:
         if   ( is_empty(self.s3server) or is_empty(self.bucket) ):
             log.fatal(f" must provide a gleaner config or (s3endpoint and s3bucket)]")
             raise Exception("must provide a gleaner config or (s3endpoint and s3bucket)]")
         return True
    def hasS3Upload(self) -&gt; bool:
         if  not self.upload and ( is_empty(self.s3server) or is_empty(self.bucket) ):
             log.fatal(f" must provide a gleaner config or (s3endpoint and s3bucket)]")
             raise Exception("must provide a gleaner config or (s3endpoint and s3bucket)]")
         return True
    def hasGraphendpoint(self, option:bool=False, message="must provide graphendpoint") -&gt; bool:
         """ if option is not true, so if summon only, then empty is graphendpoint is ok
            """
         if    not option and is_empty(self.graphendpoint) :
             log.fatal(message)
             raise Exception(message)
         return True</code></pre>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.ec_reports.EcConfig.hasGraphendpoint">
<code class="highlight language-python">hasGraphendpoint(option=False, message='must provide graphendpoint')</code>
<a class="headerlink" href="#ec.ec_reports.EcConfig.hasGraphendpoint" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>if option is not true, so if summon only, then empty is graphendpoint is ok</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/ec_reports.py</code></summary>
<pre class="highlight"><code class="language-python">def hasGraphendpoint(self, option:bool=False, message="must provide graphendpoint") -&gt; bool:
     """ if option is not true, so if summon only, then empty is graphendpoint is ok
        """
     if    not option and is_empty(self.graphendpoint) :
         log.fatal(message)
         raise Exception(message)
     return True</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.gleanerio">
<code>gleanerio</code>
<a class="headerlink" href="#ec.gleanerio" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="ec.gleanerio.gleaner">
<code>gleaner</code>
<a class="headerlink" href="#ec.gleanerio.gleaner" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.gleanerio.gleaner.getGleanerFromFile">
<code class="highlight language-python">getGleanerFromFile(cfgfile_obj)</code>
<a class="headerlink" href="#ec.gleanerio.gleaner.getGleanerFromFile" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>read a file from argparse
when reading args where a file is returned, use this one</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>cfgfile_obj</code></td>
<td>
</td>
<td>
<div class="doc-md-description">
<p>an argparse.FileType, maybe an io.FileIo</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/gleanerio/gleaner.py</code></summary>
<pre class="highlight"><code class="language-python">def getGleanerFromFile( cfgfile_obj):
    """ read a file from argparse
    when reading args where a file is returned, use this one


    Parameters:
        cfgfile_obj: an argparse.FileType, maybe an io.FileIo
    """
    cfg = yaml.safe_load(cfgfile_obj)
    bucket = cfg['minio']['bucket']
    s3endpoint = cfg['minio']['address']
    return s3endpoint,  bucket, cfg</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.gleanerio.gleaner.getNabuFromFile">
<code class="highlight language-python">getNabuFromFile(cfgfile_obj)</code>
<a class="headerlink" href="#ec.gleanerio.gleaner.getNabuFromFile" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>read a file from argparse
when reading args where a file is returned, use this one</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>cfgfile_obj</code></td>
<td>
</td>
<td>
<div class="doc-md-description">
<p>an argparse.FileType, maybe an io.FileIo</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/gleanerio/gleaner.py</code></summary>
<pre class="highlight"><code class="language-python">def getNabuFromFile( cfgfile_obj) -&gt; Tuple[str, object]:
    """ read a file from argparse
    when reading args where a file is returned, use this one


    Parameters:
        cfgfile_obj: an argparse.FileType, maybe an io.FileIo
"""

    """ when reading args where a file is returned, use this one"""
    cfg = yaml.safe_load(cfgfile_obj)
    endpoint = cfg['sparql']['endpoint']
    #     endpoint = cfg['sparql']['endpoint']
    return endpoint, cfg</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.graph">
<code>graph</code>
<a class="headerlink" href="#ec.graph" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="ec.graph.manageGraph">
<code>manageGraph</code>
<a class="headerlink" href="#ec.graph.manageGraph" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="ec.graph.manageGraph.ManageBlazegraph">
<code>ManageBlazegraph</code>
<a class="headerlink" href="#ec.graph.manageGraph.ManageBlazegraph" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ec.graph.manageGraph.ManageGraph" href="#ec.graph.manageGraph.ManageGraph">ManageGraph</a></code></p>
<p>Manages a blazegraph instance for a single namespace
implements needed portions of the blazegraph rest API</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/graph/manageGraph.py</code></summary>
<pre class="highlight"><code class="language-python">class ManageBlazegraph(ManageGraph):
    """ Manages a blazegraph instance for a single namespace
    implements needed portions of the blazegraph rest API"""

    createTemplateQuad ="""com.bigdata.namespace.fffff.spo.com.bigdata.btree.BTree.branchingFactor=1024
com.bigdata.rdf.store.AbstractTripleStore.textIndex=true
com.bigdata.namespace.fffff.lex.com.bigdata.btree.BTree.branchingFactor=400
com.bigdata.rdf.store.AbstractTripleStore.axiomsClass=com.bigdata.rdf.axioms.NoAxioms
com.bigdata.rdf.sail.isolatableIndices=false
com.bigdata.rdf.sail.truthMaintenance=false
com.bigdata.rdf.store.AbstractTripleStore.justify=false
com.bigdata.rdf.store.AbstractTripleStore.quads=true
com.bigdata.journal.Journal.groupCommit=false
com.bigdata.rdf.store.AbstractTripleStore.geoSpatial=false
com.bigdata.rdf.store.AbstractTripleStore.statementIdentifiers=false
"""

    createTemplateTriples = """com.bigdata.namespace.fffff.spo.com.bigdata.btree.BTree.branchingFactor=1024
com.bigdata.rdf.store.AbstractTripleStore.textIndex=true
com.bigdata.namespace.fffff.lex.com.bigdata.btree.BTree.branchingFactor=400
com.bigdata.rdf.store.AbstractTripleStore.axiomsClass=com.bigdata.rdf.axioms.NoAxioms
com.bigdata.rdf.sail.isolatableIndices=false
com.bigdata.rdf.sail.truthMaintenance=false
com.bigdata.rdf.store.AbstractTripleStore.justify=false
com.bigdata.rdf.sail.namespace=fffff
com.bigdata.rdf.store.AbstractTripleStore.quads=false
com.bigdata.journal.Journal.groupCommit=false
com.bigdata.rdf.store.AbstractTripleStore.geoSpatial=false
com.bigdata.rdf.store.AbstractTripleStore.statementIdentifiers=false
"""
    #init w/namespace

    def createNamespace(self, quads=True):
        """ Creates a new namespace"""
        # POST / bigdata / namespace
        # ...
        # Content - Type
        # ...
        # BODY
       # add this to the createTemplates
        # # com.bigdata.rdf.sail.namespace = {namespace}
        if quads:
            template = self.createTemplateQuad
        else:
            template = self.createTemplateTriples
        template = template + f"com.bigdata.rdf.sail.namespace = {self.namespace}\n"
        url = f"{self.baseurl}/namespace"
        headers = {"Content-Type": "text/plain"}
        r = requests.post(url,data=template, headers=headers)
        if r.status_code==201:
            return "Created"
        elif  r.status_code==409:
            return "Exists"
        else:
            raise Exception(f"Create Failed. Status code: {r.status_code} {r.reason}")


    def deleteNamespace(self):
        """ deletes a blazegraph namespace"""
        # DELETE /bigdata/namespace/NAMESPACE
        url = f"{self.baseurl}/namespace/{self.namespace}"
        headers = {"Content-Type": "text/plain"}
        r = requests.delete(url, headers=headers)
        if r.status_code == 200:
            return "Deleted"
        else:
            raise Exception("Delete Failed.")


    def insert(self, data, content_type="text/x-nquads"):
        """inserts data into a blazegraph namespace"""
        # rdf datatypes: https://github.com/blazegraph/database/wiki/REST_API#rdf-data
        # insert: https://github.com/blazegraph/database/wiki/REST_API#insert
       #url = f"{self.baseurl}/namespace/{self.namespace}{self.sparql}"
       #could call insure final slash
        url = f"{self.baseurl}/namespace/{self.namespace}/{self.sparql}"
        log.info(f'insert to {url} ')
        headers = {"Content-Type": f"{content_type}"}
        r = requests.post(url,data=data, headers=headers)
        log.debug(f' status:{r.status_code}') #status:404
        log.info(f' status:{r.status_code}') #status:404
        if r.status_code == 200:
            # '&lt;?xml version="1.0"?&gt;&lt;data modified="0" milliseconds="7"/&gt;'
            if 'data modified="0"'  in r.text:
                raise Exception("No Data Added: " + r.text)
            return True
        else:
            return False

    #have upload methods here
    #have graph instance:&lt;manageGraph.ManageBlazegraph object at ..&gt;, for url:https://graph.geocodes.ncsa.illinois.edu/blazegraph
    #tmp_endpoint=f'https://graph.geocodes.ncsa.illinois.edu/blazegraph/namespace/{repo}/sparql'

    def upload_file(self, filename, content_type="text/x-nquads"):
        "to temp namespace or final one if given"
        log.debug(f'upload_file:{filename}')
        log.info(f'upload_file:{filename}')
        #open file and insert data
        data = open(filename, 'rb').read()
        log.debug(f'insert:{filename}')
        log.info(f'insert:{filename}')
        self.insert(data, content_type)

    def upload_nq_file(self, fn=None):
        "will default to ns.nq"
        if fn:
            filename=fn
        else:
            filename=self.namespace + ".nq"
        self.upload_file(filename)

    def upload_ttl_file(self, fn=None):
        "will default to ns.ttl"
        if fn: #will want to upload ns=repo.ttl to ns=summary in the end
            filename=fn
        else:
            filename=self.namespace + ".ttl"
        self.upload_file(filename, 'Content-Type:text/x-turtle')</code></pre>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.graph.manageGraph.ManageBlazegraph.createNamespace">
<code class="highlight language-python">createNamespace(quads=True)</code>
<a class="headerlink" href="#ec.graph.manageGraph.ManageBlazegraph.createNamespace" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>Creates a new namespace</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/graph/manageGraph.py</code></summary>
<pre class="highlight"><code class="language-python">def createNamespace(self, quads=True):
    """ Creates a new namespace"""
    # POST / bigdata / namespace
    # ...
    # Content - Type
    # ...
    # BODY
   # add this to the createTemplates
    # # com.bigdata.rdf.sail.namespace = {namespace}
    if quads:
        template = self.createTemplateQuad
    else:
        template = self.createTemplateTriples
    template = template + f"com.bigdata.rdf.sail.namespace = {self.namespace}\n"
    url = f"{self.baseurl}/namespace"
    headers = {"Content-Type": "text/plain"}
    r = requests.post(url,data=template, headers=headers)
    if r.status_code==201:
        return "Created"
    elif  r.status_code==409:
        return "Exists"
    else:
        raise Exception(f"Create Failed. Status code: {r.status_code} {r.reason}")</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.graph.manageGraph.ManageBlazegraph.deleteNamespace">
<code class="highlight language-python">deleteNamespace()</code>
<a class="headerlink" href="#ec.graph.manageGraph.ManageBlazegraph.deleteNamespace" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>deletes a blazegraph namespace</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/graph/manageGraph.py</code></summary>
<pre class="highlight"><code class="language-python">def deleteNamespace(self):
    """ deletes a blazegraph namespace"""
    # DELETE /bigdata/namespace/NAMESPACE
    url = f"{self.baseurl}/namespace/{self.namespace}"
    headers = {"Content-Type": "text/plain"}
    r = requests.delete(url, headers=headers)
    if r.status_code == 200:
        return "Deleted"
    else:
        raise Exception("Delete Failed.")</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.graph.manageGraph.ManageBlazegraph.insert">
<code class="highlight language-python">insert(data, content_type='text/x-nquads')</code>
<a class="headerlink" href="#ec.graph.manageGraph.ManageBlazegraph.insert" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>inserts data into a blazegraph namespace</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/graph/manageGraph.py</code></summary>
<pre class="highlight"><code class="language-python">def insert(self, data, content_type="text/x-nquads"):
    """inserts data into a blazegraph namespace"""
    # rdf datatypes: https://github.com/blazegraph/database/wiki/REST_API#rdf-data
    # insert: https://github.com/blazegraph/database/wiki/REST_API#insert
   #url = f"{self.baseurl}/namespace/{self.namespace}{self.sparql}"
   #could call insure final slash
    url = f"{self.baseurl}/namespace/{self.namespace}/{self.sparql}"
    log.info(f'insert to {url} ')
    headers = {"Content-Type": f"{content_type}"}
    r = requests.post(url,data=data, headers=headers)
    log.debug(f' status:{r.status_code}') #status:404
    log.info(f' status:{r.status_code}') #status:404
    if r.status_code == 200:
        # '&lt;?xml version="1.0"?&gt;&lt;data modified="0" milliseconds="7"/&gt;'
        if 'data modified="0"'  in r.text:
            raise Exception("No Data Added: " + r.text)
        return True
    else:
        return False</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.graph.manageGraph.ManageBlazegraph.upload_file">
<code class="highlight language-python">upload_file(filename, content_type='text/x-nquads')</code>
<a class="headerlink" href="#ec.graph.manageGraph.ManageBlazegraph.upload_file" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>to temp namespace or final one if given</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/graph/manageGraph.py</code></summary>
<pre class="highlight"><code class="language-python">def upload_file(self, filename, content_type="text/x-nquads"):
    "to temp namespace or final one if given"
    log.debug(f'upload_file:{filename}')
    log.info(f'upload_file:{filename}')
    #open file and insert data
    data = open(filename, 'rb').read()
    log.debug(f'insert:{filename}')
    log.info(f'insert:{filename}')
    self.insert(data, content_type)</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.graph.manageGraph.ManageBlazegraph.upload_nq_file">
<code class="highlight language-python">upload_nq_file(fn=None)</code>
<a class="headerlink" href="#ec.graph.manageGraph.ManageBlazegraph.upload_nq_file" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>will default to ns.nq</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/graph/manageGraph.py</code></summary>
<pre class="highlight"><code class="language-python">def upload_nq_file(self, fn=None):
    "will default to ns.nq"
    if fn:
        filename=fn
    else:
        filename=self.namespace + ".nq"
    self.upload_file(filename)</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.graph.manageGraph.ManageBlazegraph.upload_ttl_file">
<code class="highlight language-python">upload_ttl_file(fn=None)</code>
<a class="headerlink" href="#ec.graph.manageGraph.ManageBlazegraph.upload_ttl_file" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>will default to ns.ttl</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/graph/manageGraph.py</code></summary>
<pre class="highlight"><code class="language-python">def upload_ttl_file(self, fn=None):
    "will default to ns.ttl"
    if fn: #will want to upload ns=repo.ttl to ns=summary in the end
        filename=fn
    else:
        filename=self.namespace + ".ttl"
    self.upload_file(filename, 'Content-Type:text/x-turtle')</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="ec.graph.manageGraph.ManageGraph">
<code>ManageGraph</code>
<a class="headerlink" href="#ec.graph.manageGraph.ManageGraph" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Abstract class for managing a Graph Store
instance for a single namespace</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/graph/manageGraph.py</code></summary>
<pre class="highlight"><code class="language-python">class ManageGraph: #really a manage graph namespace, bc a graph has several of them, &amp;this represents only one
    """ Abstract class for managing a Graph Store
     instance for a single namespace
    """
    baseurl = "http://localhost:3030" # basically fuskei
    namespace = "temp_summary"
    path = "namespace"
    sparql = "/sparql" # blazegraph uses sparql after namespace, but let's not assume this

    def __init__(self, graphurl: str, namespace :str) :
        """initialize a class for a namespace"""
        self.baseurl = graphurl
        self.namespace = namespace
    def graphFromEndpoint(endpoint: str) -&gt; str:
        paths = endpoint.split('/')
        paths = paths[0:len(paths) -3]
        newurl = '/'.join(paths)
        return newurl
    def createNamespace(self, quads=True):
        """ create a new namespace"""
        pass

    def deleteNamespace(self):
        """delete a namespace"""
        pass</code></pre>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.graph.manageGraph.ManageGraph.__init__">
<code class="highlight language-python">__init__(graphurl, namespace)</code>
<a class="headerlink" href="#ec.graph.manageGraph.ManageGraph.__init__" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>initialize a class for a namespace</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/graph/manageGraph.py</code></summary>
<pre class="highlight"><code class="language-python">def __init__(self, graphurl: str, namespace :str) :
    """initialize a class for a namespace"""
    self.baseurl = graphurl
    self.namespace = namespace</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.graph.manageGraph.ManageGraph.createNamespace">
<code class="highlight language-python">createNamespace(quads=True)</code>
<a class="headerlink" href="#ec.graph.manageGraph.ManageGraph.createNamespace" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>create a new namespace</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/graph/manageGraph.py</code></summary>
<pre class="highlight"><code class="language-python">def createNamespace(self, quads=True):
    """ create a new namespace"""
    pass</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.graph.manageGraph.ManageGraph.deleteNamespace">
<code class="highlight language-python">deleteNamespace()</code>
<a class="headerlink" href="#ec.graph.manageGraph.ManageGraph.deleteNamespace" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>delete a namespace</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/graph/manageGraph.py</code></summary>
<pre class="highlight"><code class="language-python">def deleteNamespace(self):
    """delete a namespace"""
    pass</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="ec.graph.sparql_query">
<code>sparql_query</code>
<a class="headerlink" href="#ec.graph.sparql_query" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>This basically wraps sparqldataframe,
and contains a way to get resources that are the sparql queries,
and few helpers to basic queries</p>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.graph.sparql_query._getSparqlFileFromResources">
<code class="highlight language-python">_getSparqlFileFromResources(filename)</code>
<a class="headerlink" href="#ec.graph.sparql_query._getSparqlFileFromResources" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>retrieves sparql file from the sparql_files folder when in a package</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/graph/sparql_query.py</code></summary>
<pre class="highlight"><code class="language-python">def _getSparqlFileFromResources(filename) -&gt; str:
    """ retrieves sparql file from the sparql_files folder when in a package"""
    resourcename = f"{filename}.sparql"
    resource = pkg_resources.read_text(sparqlfiles, resourcename)
    return resource</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.graph.sparql_query.getAGraph">
<code class="highlight language-python">getAGraph(g, endpoint)</code>
<a class="headerlink" href="#ec.graph.sparql_query.getAGraph" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Query a SPARQL endpoint and return a Pandas Dataframe for a geocodes object</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/graph/sparql_query.py</code></summary>
<pre class="highlight"><code class="language-python">def getAGraph(  g, endpoint: str) -&gt; pandas.DataFrame:
    """Query a SPARQL endpoint and return a Pandas Dataframe for a geocodes object"""
    query = _getSparqlFileFromResources('urn_triples_for_a_graph')
    q_template = Template(query)
    thsGraphQuery = q_template.substitute(urn=g)
    g_df = sparqldataframe.query(endpoint, thsGraphQuery)

    return g_df</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.graph.sparql_query.listSparqlFilesFromResources">
<code class="highlight language-python">listSparqlFilesFromResources()</code>
<a class="headerlink" href="#ec.graph.sparql_query.listSparqlFilesFromResources" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>retrieves sparql file from the sparql_files folder when in a package</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/graph/sparql_query.py</code></summary>
<pre class="highlight"><code class="language-python">def listSparqlFilesFromResources() -&gt; str:
    """ retrieves sparql file from the sparql_files folder when in a package"""
    resource = pkg_resources.contents(sparqlfiles)
    files = filter( lambda f: ends_with(f, ".sparql"), resource)
    files = map(lambda f: replace_end(f,".sparql",""), files)
    files = sort(list(files))
    return files</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.graph.sparql_query.queryWithSparql">
<code class="highlight language-python">queryWithSparql(template_name, endpoint, parameters={})</code>
<a class="headerlink" href="#ec.graph.sparql_query.queryWithSparql" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Query a SPARQL endpoint, and return a Pandas Dataframe</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>template_name</code></td>
<td>
<code>str</code>
</td>
<td>
<div class="doc-md-description">
<p>name of templates in the ec.graph.sparql_files directory</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>endpoint</code></td>
<td>
<code>str</code>
</td>
<td>
<div class="doc-md-description">
<p>SPARQL endpoint url</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>parameters</code></td>
<td>
<code>object</code>
</td>
<td>
<div class="doc-md-description">
<p>object with the names to fill in template eg {"repo": "reponame"}</p>
</div>
</td>
<td>
<code>{}</code>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/graph/sparql_query.py</code></summary>
<pre class="highlight"><code class="language-python">def queryWithSparql( template_name : str, endpoint : str,parameters:object={}) -&gt; pandas.DataFrame:
    """ Query a SPARQL endpoint, and return a Pandas Dataframe

    Parameters:
       template_name: name of templates in the ec.graph.sparql_files directory
       endpoint: SPARQL endpoint url
       parameters: object with the names to fill in template eg {"repo": "reponame"}
    """
    query = _getSparqlFileFromResources(f"{template_name}")
    q_template = Template(query)
    thsGraphQuery = q_template.substitute(parameters)
    q_df = sparqldataframe.query(endpoint, thsGraphQuery)
    return q_df</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.logger">
<code>logger</code>
<a class="headerlink" href="#ec.logger" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="ec.logger.log">
<code>log</code>
<a class="headerlink" href="#ec.logger.log" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.logger.log.config_app">
<code class="highlight language-python">config_app()</code>
<a class="headerlink" href="#ec.logger.log.config_app" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Use this to set default logging behavior while in a console application</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/logger/log.py</code></summary>
<pre class="highlight"><code class="language-python">def config_app() -&gt; Logger:
    """Use this to set default logging behavior while in a console application"""
    logging.basicConfig(format='%(levelname)s : %(message)s', level=os.environ.get("LOGLEVEL", "INFO"),
                        stream=sys.stdout)
    log = logging.getLogger()
    return log</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.logger.log.config_notebook">
<code class="highlight language-python">config_notebook()</code>
<a class="headerlink" href="#ec.logger.log.config_notebook" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Use this to get default logging behavior while in a notebook</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/logger/log.py</code></summary>
<pre class="highlight"><code class="language-python">def config_notebook() -&gt; Logger:
    """Use this to get default logging behavior while in a notebook"""
    logging.basicConfig(format='%(levelname)s : %(message)s', level=os.environ.get("LOGLEVEL", "INFO"),
                        stream=sys.stdout)
    log = logging.getLogger()
    return log</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.logger.log.config_web">
<code class="highlight language-python">config_web()</code>
<a class="headerlink" href="#ec.logger.log.config_web" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Use this to set default logging behavior a web applicaiton like Flask</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/logger/log.py</code></summary>
<pre class="highlight"><code class="language-python">def config_web() -&gt; Logger:
    """Use this to set default logging behavior a web applicaiton like Flask"""
    logging.basicConfig(format='%(levelname)s : %(message)s', level=os.environ.get("LOGLEVEL", "INFO"),
                        stream=sys.stdout)
    log = logging.getLogger()
    return log</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.missing_report">
<code>missing_report</code>
<a class="headerlink" href="#ec.missing_report" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ec.missing_report.start">
<code class="highlight language-python">start()</code>
<a class="headerlink" href="#ec.missing_report.start" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Run the write_missing_report program.
Get a list of active repositories from the gleaner file.
For each repository, generate missing reports and write these information to a json file and upload it to s3.
Arguments:
    args: Arguments passed from the command line.
Returns:
    An exit code.</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/missing_report.py</code></summary>
<pre class="highlight"><code class="language-python">def start():
    """
        Run the write_missing_report program.
        Get a list of active repositories from the gleaner file.
        For each repository, generate missing reports and write these information to a json file and upload it to s3.
        Arguments:
            args: Arguments passed from the command line.
        Returns:
            An exit code.
    """
    exitcode = writeMissingReport()
    sys.exit(exitcode)</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.notebook">
<code>notebook</code>
<a class="headerlink" href="#ec.notebook" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ec.notebook.get_from_geocodes">
<code class="highlight language-python">get_from_geocodes(urn, endpoint='https://graph.geocodes-dev.earthcube.org/blazegraph/namespace/earthcube/sparql')</code>
<a class="headerlink" href="#ec.notebook.get_from_geocodes" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>get an object from the graph, and return as a JSON-LD file</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/notebook/geocodes.py</code></summary>
<pre class="highlight"><code class="language-python">def get_from_geocodes(urn, endpoint="https://graph.geocodes-dev.earthcube.org/blazegraph/namespace/earthcube/sparql"):
    """get an object from the graph, and return as a JSON-LD file """
    manager = EcObjectManager(endpoint, None, None)
    return manager.getFromStore(urn, source='graph', form='jsonld')</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ec.notebook.get_jsfile2dict">
<code class="highlight language-python">get_jsfile2dict(fn)</code>
<a class="headerlink" href="#ec.notebook.get_jsfile2dict" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>get jsonfile as dict</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/notebook/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def get_jsfile2dict(fn):
    "get jsonfile as dict"
    #s=get_txtfile(fn)
    #return json.loads(s)
    with open(fn, "r") as f:
        return json.load(f)</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ec.notebook.get_txtfile">
<code class="highlight language-python">get_txtfile(fn)</code>
<a class="headerlink" href="#ec.notebook.get_txtfile" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>ret str from file</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/notebook/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def get_txtfile(fn):
    "ret str from file"
    with open(fn, "r") as f:
        return f.read()</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ec.notebook.inCollab">
<code class="highlight language-python">inCollab()</code>
<a class="headerlink" href="#ec.notebook.inCollab" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Is this notebook being run in Goolge Collab</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/notebook/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def inCollab():
    """ Is this notebook being run in Goolge Collab"""
    return  'google.colab' in sys.modules</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ec.notebook.put_txtfile">
<code class="highlight language-python">put_txtfile(fn, s, wa='w')</code>
<a class="headerlink" href="#ec.notebook.put_txtfile" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>filename to dump string to</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/notebook/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def put_txtfile(fn,s,wa="w"):
    "filename to dump string to"
    #with open(fn, "w") as f:
    with open(fn, "a") as f:
        return f.write(s)</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="ec.notebook.geocodes">
<code>geocodes</code>
<a class="headerlink" href="#ec.notebook.geocodes" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.notebook.geocodes.get_from_geocodes">
<code class="highlight language-python">get_from_geocodes(urn, endpoint='https://graph.geocodes-dev.earthcube.org/blazegraph/namespace/earthcube/sparql')</code>
<a class="headerlink" href="#ec.notebook.geocodes.get_from_geocodes" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>get an object from the graph, and return as a JSON-LD file</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/notebook/geocodes.py</code></summary>
<pre class="highlight"><code class="language-python">def get_from_geocodes(urn, endpoint="https://graph.geocodes-dev.earthcube.org/blazegraph/namespace/earthcube/sparql"):
    """get an object from the graph, and return as a JSON-LD file """
    manager = EcObjectManager(endpoint, None, None)
    return manager.getFromStore(urn, source='graph', form='jsonld')</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="ec.notebook.utils">
<code>utils</code>
<a class="headerlink" href="#ec.notebook.utils" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.notebook.utils.get_jsfile2dict">
<code class="highlight language-python">get_jsfile2dict(fn)</code>
<a class="headerlink" href="#ec.notebook.utils.get_jsfile2dict" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>get jsonfile as dict</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/notebook/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def get_jsfile2dict(fn):
    "get jsonfile as dict"
    #s=get_txtfile(fn)
    #return json.loads(s)
    with open(fn, "r") as f:
        return json.load(f)</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.notebook.utils.get_txtfile">
<code class="highlight language-python">get_txtfile(fn)</code>
<a class="headerlink" href="#ec.notebook.utils.get_txtfile" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>ret str from file</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/notebook/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def get_txtfile(fn):
    "ret str from file"
    with open(fn, "r") as f:
        return f.read()</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.notebook.utils.inCollab">
<code class="highlight language-python">inCollab()</code>
<a class="headerlink" href="#ec.notebook.utils.inCollab" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Is this notebook being run in Goolge Collab</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/notebook/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def inCollab():
    """ Is this notebook being run in Goolge Collab"""
    return  'google.colab' in sys.modules</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.notebook.utils.put_txtfile">
<code class="highlight language-python">put_txtfile(fn, s, wa='w')</code>
<a class="headerlink" href="#ec.notebook.utils.put_txtfile" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>filename to dump string to</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/notebook/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def put_txtfile(fn,s,wa="w"):
    "filename to dump string to"
    #with open(fn, "w") as f:
    with open(fn, "a") as f:
        return f.write(s)</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.reporting">
<code>reporting</code>
<a class="headerlink" href="#ec.reporting" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="ec.reporting.report">
<code>report</code>
<a class="headerlink" href="#ec.reporting.report" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.reporting.report.compareSummoned2Graph">
<code class="highlight language-python">compareSummoned2Graph(bucket, repo, datastore, graphendpoint)</code>
<a class="headerlink" href="#ec.reporting.report.compareSummoned2Graph" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>return list of missing .
we do not alway generate a milled.</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/reporting/report.py</code></summary>
<pre class="highlight"><code class="language-python">def compareSummoned2Graph(bucket, repo, datastore: bucketDatastore, graphendpoint):
    """ return list of missing .
    we do not alway generate a milled.
    """
    # compare using s3, listJsonld(bucket, repo) to queryWithSparql("repo_select_graphs", release_file)
    summoned_list = datastore.listSummonedSha(bucket, repo)
    graph_urns = ec.graph.sparql_query.queryWithSparql("repo_select_graphs",graphendpoint,{"repo":repo})
    graph_shas = list(map(lambda u: pydash.strings.substr_right_end(u, ":"), graph_urns['g']))
    difference = pydash.arrays.difference(summoned_list, graph_shas)
    return {
        "summoned_count": pydash.collections.size(summoned_list),
        "milled_count": pydash.collections.size(graph_shas),
            "missing": difference
            }</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.reporting.report.compareSummoned2Milled">
<code class="highlight language-python">compareSummoned2Milled(bucket, repo, datastore)</code>
<a class="headerlink" href="#ec.reporting.report.compareSummoned2Milled" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>return list of missing urns/urls
Generating milled will be good to catch such errors</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/reporting/report.py</code></summary>
<pre class="highlight"><code class="language-python">def compareSummoned2Milled(bucket, repo, datastore: bucketDatastore):
    """ return list of missing urns/urls
    Generating milled will be good to catch such errors"""
    # compare using s3, listJsonld(bucket, repo) to  listMilledRdf(bucket, repo)
    summoned_list = datastore.listSummonedSha(bucket, repo)
    milled_list = datastore.listMilledSha(bucket, repo)
    difference = pydash.arrays.difference(summoned_list, milled_list)
    return {
        "summoned_count": pydash.collections.size(summoned_list),
        "milled_count": pydash.collections.size(milled_list),
            "missing": difference
            }</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.reporting.report.getGraphReportsLatestRepoReports">
<code class="highlight language-python">getGraphReportsLatestRepoReports(repo, datastore)</code>
<a class="headerlink" href="#ec.reporting.report.getGraphReportsLatestRepoReports" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>get the latest for a dashboard</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/reporting/report.py</code></summary>
<pre class="highlight"><code class="language-python">def getGraphReportsLatestRepoReports(repo,  datastore: bucketDatastore):
    """get the latest for a dashboard"""
    date="latest"
    path = f"{datastore.paths['reports']}/{repo}/{date}/sparql.json"
    filelist = datastore.getReportFile(datastore.default_bucket, repo, path)</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.reporting.report.get_url_from_sha_list">
<code class="highlight language-python">get_url_from_sha_list(shas, bucket, repo, datastore)</code>
<a class="headerlink" href="#ec.reporting.report.get_url_from_sha_list" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>if a repo has issues with milling or loading to a graph, then get the summoned file</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/reporting/report.py</code></summary>
<pre class="highlight"><code class="language-python">def get_url_from_sha_list(shas: list,  bucket, repo, datastore: bucketDatastore):
    """if a repo has issues with milling or loading to a graph, then get the summoned file"""

    pass</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.reporting.report.listGraphReportDates4Repo">
<code class="highlight language-python">listGraphReportDates4Repo(repo, datastore)</code>
<a class="headerlink" href="#ec.reporting.report.listGraphReportDates4Repo" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>get the latest for a dashboard</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/reporting/report.py</code></summary>
<pre class="highlight"><code class="language-python">def listGraphReportDates4Repo(repo,  datastore: bucketDatastore):
    """get the latest for a dashboard"""
    path = f"{datastore.paths['reports']}/{repo}/"
    filelist = datastore.listPath(path)
    return filelist</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.sitemap">
<code>sitemap</code>
<a class="headerlink" href="#ec.sitemap" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="ec.sitemap.sitemap">
<code>sitemap</code>
<a class="headerlink" href="#ec.sitemap.sitemap" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="ec.sitemap.sitemap.GleanerioSourceSitemap">
<code>GleanerioSourceSitemap</code>
<a class="headerlink" href="#ec.sitemap.sitemap.GleanerioSourceSitemap" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="ec.sitemap.sitemap.Sitemap" href="#ec.sitemap.sitemap.Sitemap">Sitemap</a></code></p>
<p>For a provided GleanerIO source record, create a Sitemap object to utilize</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sitemap/sitemap.py</code></summary>
<pre class="highlight"><code class="language-python">class GleanerioSourceSitemap(Sitemap):
    """ For a provided GleanerIO source record, create a Sitemap object to utilize"""
    source= None

    def __init__(self, source):
        self.self.source = source
        if source["sourcetype"] !=  "sitemap":
            return Exception("source is Not a sitemap")
        super.__init__(source.url, reponame= source.name)

    def get_status(self):
        s = self.source
        return  { 'name': s.name , 'code': _urlResponse( s.get("url") ), 'description': "res", 'url': s.get("description"), 'type': s.get("sourcetype")}</code></pre>
</details>
<div class="doc doc-children">
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h4 class="doc doc-heading" id="ec.sitemap.sitemap.Sitemap">
<code>Sitemap</code>
<a class="headerlink" href="#ec.sitemap.sitemap.Sitemap" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>This holds information about a sitemap, and allows for testing of the
URLS in the sitemap to see if they exist.
If the sitemap URL does not exist, then it will return a Sitemap, with an
len(errors) &gt; 0.</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sitemap/sitemap.py</code></summary>
<pre class="highlight"><code class="language-python">class Sitemap():
    """ This holds information about a sitemap, and allows for testing of the
    URLS in the sitemap to see if they exist.
    If the sitemap URL does not exist, then it will return a Sitemap, with an
    len(errors) &gt; 0.

    """
    sitemapurl = None
    _validSitemap = True
    sitemap_df = pandas.DataFrame()
    _checkedUrls=False
    def __init__(self, sitemapurl, repoName="", no_progress_bar=False):
        self.errors=[]
        self.sitemapurl = sitemapurl
        self.no_progress_bar = no_progress_bar
        if _urlExists(sitemapurl):
            self.sitemap_df = adv.sitemap_to_df(sitemapurl)
            self._validSitemap = True
        else:
            self.errors.append(f"sitemap url invalid: {sitemapurl}")
            self._validSitemap = False
            # the other option is to return None.

    def validUrl(self) -&gt; bool:
        """ does the provided sitemap URL exist."""
        return self._validSitemap

    def errors(self):
        return self.errors
    def uniqueItems(self):
        """list of unqiue sitemaps records"""
        return self.sitemap_df.sitemap.unique().tolist()

    def uniqueUrls(self) :
        """Returns a pandas series of the URLS'"""
        return self.sitemap_df["loc"].unique().tolist()

    def check_urls(self) -&gt; DataFrame:
        """This will run head on the list of url's in the pandas dataframe.
        It will append columns ("url_response","content_type") to the sitemap_df
        """

        # add columns to the dataframe. clear out any previous values
        df = self.sitemap_df
        df["url_response"]=None
        df["content_type"]=None

        if not self._validSitemap:
            self._checkedUrls = True
            return df

        pandarallel.initialize(progress_bar=self.no_progress_bar)
        df["url_response"],df["content_type"]=  zip(*df.parallel_apply(lambda row:
                           _urlResponse(row.get('loc')),
                           axis=1))
        self._checkedUrls =True
        return df

    def get_url_report(self) -&gt; str:
        """returns a csv of the 'loc','lastmod','url_response', 'content_type' """
        if not self._checkedUrls:
            self.check_urls()
        out= StringIO()
        self.sitemap_df.to_csv(out, index=False, quoting=csv.QUOTE_ALL,
                columns=['loc','lastmod','url_response', 'content_type']
              #                 columns=['loc','lastmod',"url_response/content_type"]
                               )
        return out.getvalue()</code></pre>
</details>
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.sitemap.sitemap.Sitemap.get_url_report">
<code class="highlight language-python">get_url_report()</code>
<a class="headerlink" href="#ec.sitemap.sitemap.Sitemap.get_url_report" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>returns a csv of the 'loc','lastmod','url_response', 'content_type'</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sitemap/sitemap.py</code></summary>
<pre class="highlight"><code class="language-python">def get_url_report(self) -&gt; str:
    """returns a csv of the 'loc','lastmod','url_response', 'content_type' """
    if not self._checkedUrls:
        self.check_urls()
    out= StringIO()
    self.sitemap_df.to_csv(out, index=False, quoting=csv.QUOTE_ALL,
            columns=['loc','lastmod','url_response', 'content_type']
          #                 columns=['loc','lastmod',"url_response/content_type"]
                           )
    return out.getvalue()</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.sitemap.sitemap.Sitemap.uniqueItems">
<code class="highlight language-python">uniqueItems()</code>
<a class="headerlink" href="#ec.sitemap.sitemap.Sitemap.uniqueItems" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>list of unqiue sitemaps records</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sitemap/sitemap.py</code></summary>
<pre class="highlight"><code class="language-python">def uniqueItems(self):
    """list of unqiue sitemaps records"""
    return self.sitemap_df.sitemap.unique().tolist()</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.sitemap.sitemap.Sitemap.uniqueUrls">
<code class="highlight language-python">uniqueUrls()</code>
<a class="headerlink" href="#ec.sitemap.sitemap.Sitemap.uniqueUrls" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>Returns a pandas series of the URLS'</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sitemap/sitemap.py</code></summary>
<pre class="highlight"><code class="language-python">def uniqueUrls(self) :
    """Returns a pandas series of the URLS'"""
    return self.sitemap_df["loc"].unique().tolist()</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h5 class="doc doc-heading" id="ec.sitemap.sitemap.Sitemap.validUrl">
<code class="highlight language-python">validUrl()</code>
<a class="headerlink" href="#ec.sitemap.sitemap.Sitemap.validUrl" title="Permanent link"></a></h5>
<div class="doc doc-contents">
<p>does the provided sitemap URL exist.</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sitemap/sitemap.py</code></summary>
<pre class="highlight"><code class="language-python">def validUrl(self) -&gt; bool:
    """ does the provided sitemap URL exist."""
    return self._validSitemap</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.sitemap.sitemap._urlResponse">
<code class="highlight language-python">_urlResponse(item_loc)</code>
<a class="headerlink" href="#ec.sitemap.sitemap._urlResponse" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>return response code, content type,</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sitemap/sitemap.py</code></summary>
<pre class="highlight"><code class="language-python">def _urlResponse(item_loc: str):
    """return response code, content type, """
    try:
        r = requests.head(item_loc)
        if r.status_code != 200:
            return [r.status_code, None]
        else:
            content_type = r.headers.get("Content-Type")
            return [r.status_code, content_type]
    except:
        return [400, None]</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.sos_json">
<code>sos_json</code>
<a class="headerlink" href="#ec.sos_json" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="ec.sos_json.rdf">
<code>rdf</code>
<a class="headerlink" href="#ec.sos_json.rdf" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.sos_json.rdf.createRDFNode">
<code class="highlight language-python">createRDFNode(nodeValue)</code>
<a class="headerlink" href="#ec.sos_json.rdf.createRDFNode" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>fix_url and quote otherwise</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sos_json/rdf.py</code></summary>
<pre class="highlight"><code class="language-python">def createRDFNode(nodeValue: str) -&gt; Union[Literal, BNode ,URIRef]:
    "fix_url and quote otherwise"
    if not isinstance(nodeValue,str):
        if  (nodeValue is None) or  (pandas.isnull(nodeValue)):
            return Literal("")
        return Literal(nodeValue)
    else:
        if nodeValue.startswith("&lt;ht"):
            return URIRef(nodeValue)
        elif nodeValue.startswith("_:B"):
            return BNode(nodeValue.replace("_:B", "B"))
        elif nodeValue.startswith("t1"):
            return BNode(nodeValue.replace("t1", "Bt1"))
        elif is_http(nodeValue):
            return URIRef(nodeValue)
        elif nodeValue.startswith("doi:"):
            return URIRef(nodeValue)
        elif nodeValue.startswith("DOI:"):
            return URIRef(nodeValue)
        #elif obj:
        elif nodeValue is None:
            return Literal("")
        elif pandas.isnull(nodeValue):
            return Literal("")
        else:
            # import json
            # return json.dumps(url)
           return Literal(nodeValue)</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.sos_json.rdf.df2rdfgraph">
<code class="highlight language-python">df2rdfgraph(df)</code>
<a class="headerlink" href="#ec.sos_json.rdf.df2rdfgraph" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>print out df as .nt file</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sos_json/rdf.py</code></summary>
<pre class="highlight"><code class="language-python">def df2rdfgraph(df: pandas.DataFrame):
    "print out df as .nt file"

    g = Graph()
    g.bind("schema", "https://schema.org/")
    for index, row in df.iterrows():
        s=df["s"][index]
        s=createRDFNode(s)
        p=df["p"][index]
        p=createRDFNode(p)
        o=df["o"][index]
        o=createRDFNode(o)
        g.add((s, p, o))

        #need to finish up w/dumping to a file
    return  g</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.sos_json.rdf.get_graph2jsonld">
<code class="highlight language-python">get_graph2jsonld(urn, endpoint, form='compact', schemaType='Dataset')</code>
<a class="headerlink" href="#ec.sos_json.rdf.get_graph2jsonld" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>get jsonld from endpoint</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>urn</code></td>
<td>
<code>str</code>
</td>
<td>
<div class="doc-md-description">
<p>?g from sparql query. URN of the graph eg. urn:gleaner.io:earthcube:geocodes_demo_datasets:257108e0760f96ef7a480e1d357bcf8720cd11e4</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>form</code></td>
<td>
</td>
<td>
<div class="doc-md-description">
<p>jsonld| compact, frame</p>
</div>
</td>
<td>
<code>'compact'</code>
</td>
</tr>
<tr class="doc-section-item">
<td><code>schemaType</code></td>
<td>
</td>
<td>
<div class="doc-md-description">
<p>if form=frame then this type is passed to the frame</p>
</div>
</td>
<td>
<code>'Dataset'</code>
</td>
</tr>
<tr class="doc-section-item">
<td><code>endpoint</code></td>
<td>
<code>str</code>
</td>
<td>
<div class="doc-md-description">
<p>sparql endpoint</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sos_json/rdf.py</code></summary>
<pre class="highlight"><code class="language-python">def get_graph2jsonld(urn: str, endpoint:str, form="compact", schemaType="Dataset") -&gt; str:
    """get jsonld from endpoint

    Parameters:
        urn: ?g from sparql query. URN of the graph eg. urn:gleaner.io:earthcube:geocodes_demo_datasets:257108e0760f96ef7a480e1d357bcf8720cd11e4
        form: jsonld| compact, frame
        schemaType: if form=frame then this type is passed to the frame
        endpoint: sparql endpoint

    """
    g = get_rdfgraph(urn, endpoint)

    return graph2jsonld(g, form=form, schemaType=schemaType)</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.sos_json.rdf.get_rdf2jld_str">
<code class="highlight language-python">get_rdf2jld_str(urn, endpoint)</code>
<a class="headerlink" href="#ec.sos_json.rdf.get_rdf2jld_str" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>get jsonld from endpoint</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sos_json/rdf.py</code></summary>
<pre class="highlight"><code class="language-python">def get_rdf2jld_str(urn: str, endpoint:str) -&gt; str:
    "get jsonld from endpoint"
    g= get_rdfgraph(urn, endpoint)
    jld_str = g.serialize(format="json-ld")
    return compact_jld_str(jld_str)</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.sos_json.rdf.graph2jsonld">
<code class="highlight language-python">graph2jsonld(g, form='jsonld', schemaType='Dataset')</code>
<a class="headerlink" href="#ec.sos_json.rdf.graph2jsonld" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>get jsonld from endpoint</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>g</code></td>
<td>
</td>
<td>
<div class="doc-md-description">
<p>?g from sparql query. URN of the graph eg. urn:gleaner.io:earthcube:geocodes_demo_datasets:257108e0760f96ef7a480e1d357bcf8720cd11e4</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>form</code></td>
<td>
</td>
<td>
<div class="doc-md-description">
<p>jsonld| compact, frame</p>
</div>
</td>
<td>
<code>'jsonld'</code>
</td>
</tr>
<tr class="doc-section-item">
<td><code>schemaType</code></td>
<td>
</td>
<td>
<div class="doc-md-description">
<p>if form=frame then this type is passed to the frame</p>
</div>
</td>
<td>
<code>'Dataset'</code>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sos_json/rdf.py</code></summary>
<pre class="highlight"><code class="language-python">def graph2jsonld(g, form="jsonld", schemaType="Dataset") -&gt; str:
    """get jsonld from endpoint

    Parameters:
        g: ?g from sparql query. URN of the graph eg. urn:gleaner.io:earthcube:geocodes_demo_datasets:257108e0760f96ef7a480e1d357bcf8720cd11e4
        form: jsonld| compact, frame
        schemaType: if form=frame then this type is passed to the frame
    """
    # auto_compact=False might change
    jld_str = g.serialize(format="json-ld")

    return formatted_jsonld(jld_str, form=form, schemaType=schemaType)</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.sos_json.rdf.load_release">
<code class="highlight language-python">load_release(releaseurl)</code>
<a class="headerlink" href="#ec.sos_json.rdf.load_release" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>retrieves a release from the url</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sos_json/rdf.py</code></summary>
<pre class="highlight"><code class="language-python">def load_release(releaseurl:str) -&gt; Graph:
    """retrieves a release from the url"""
    g= Dataset()
    g.parse(releaseurl, format='nquads')
    return g</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="ec.sos_json.utils">
<code>utils</code>
<a class="headerlink" href="#ec.sos_json.utils" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.sos_json.utils._getSchemaFromResources">
<code class="highlight language-python">_getSchemaFromResources(filename)</code>
<a class="headerlink" href="#ec.sos_json.utils._getSchemaFromResources" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>retrieves json schema file from the  ec.sos_json.schemas directory when in a package</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sos_json/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def _getSchemaFromResources(filename) :
    """ retrieves json schema file from the  ec.sos_json.schemas directory when in a package"""
    resourcename = f"{filename}.json"
    resource = pkg_resources.read_text(schemafiles, resourcename)
    schema = json.loads(resource)
    return schema</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.sos_json.utils.compact_jld_str">
<code class="highlight language-python">compact_jld_str(jld_str)</code>
<a class="headerlink" href="#ec.sos_json.utils.compact_jld_str" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>depreciated use formatted_jsonld</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sos_json/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def compact_jld_str(jld_str: str) -&gt; str:
    """
       depreciated use formatted_jsonld

    """
    doc = json.loads(jld_str)
    compacted = jsonld.compact(doc, jsonld_context)
    r = json.dumps(compacted, indent=2)
    return r</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.sos_json.utils.formatted_jsonld">
<code class="highlight language-python">formatted_jsonld(jld_str, form='compact', schemaType='Dataset')</code>
<a class="headerlink" href="#ec.sos_json.utils.formatted_jsonld" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>returns a formatted JSONLD string based on the input
 Parameters:
     jld_str: jsonld string returns the string
     form: 'compact'--compact form,
            'frome'--framed usngin schemaType,
            'jsonld' - passed form
     schemaType: type of the schema default="Dataset"
 Returns:
     string.</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sos_json/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def formatted_jsonld(jld_str: str, form="compact", schemaType="Dataset") -&gt; str:
    """
       returns a formatted JSONLD string based on the input
        Parameters:
            jld_str: jsonld string returns the string
            form: 'compact'--compact form,
                   'frome'--framed usngin schemaType,
                   'jsonld' - passed form
            schemaType: type of the schema default="Dataset"
        Returns:
            string.

    """
    if (form == 'jsonld'):
        return jld_str

    elif (form == "frame"):
        frame = (' {\n'
                 '              "@context": {\n'
                 '                "@vocab": "https://schema.org/",\n'
                 '                    "rdf": "http://www.w3.org/1999/02/22-rdf-syntax-ns#",\n'
                 '                    "rdfs": "http://www.w3.org/2000/01/rdf-schema#",\n'
                 '                    "schema": "https://schema.org/",\n'
                 '                    "xsd": "http://www.w3.org/2001/XMLSchema#"\n'
                 '              },\n'
                 '              "@type": "schema:${schemaType}"\n'
                 '  }\n '
                 )
        f_template = Template(frame)
        thsGraphQuery = f_template.substitute(schemaType=schemaType)

        frame_doc = json.loads(thsGraphQuery)
        doc = json.loads(jld_str)
 #       doc = jsonld.flatten(doc)
        # issue where @id on Dataset and @id on Dataset.identifer were the same. If so
        # @type = ['Dataset', 'PropertyValue'] was the conversion.

        framed = jsonld.frame(doc, frame_doc)

        r = json.dumps(framed, indent=2)
        return r
    else:  # compact
        doc = json.loads(jld_str)
        compacted = jsonld.compact(doc, jsonld_context)
        r = json.dumps(compacted, indent=2)
        return r</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.sos_json.utils.isValidJSON">
<code class="highlight language-python">isValidJSON(jsonData)</code>
<a class="headerlink" href="#ec.sos_json.utils.isValidJSON" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>Is Json Valid</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sos_json/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def isValidJSON(jsonData: str)-&gt; bool:
    """Is Json Valid"""
    try:
        json.loads(jsonData)
    except ValueError as err:
        return False
    return True</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.sos_json.utils.listSchemaFilesFromResources">
<code class="highlight language-python">listSchemaFilesFromResources()</code>
<a class="headerlink" href="#ec.sos_json.utils.listSchemaFilesFromResources" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>retrieves schema file from the schemas folder when in a package</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sos_json/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def listSchemaFilesFromResources() -&gt; str:
    """ retrieves schema file from the schemas folder when in a package"""
    resource = pkg_resources.contents(schemafiles)
    files = filter( lambda f: ends_with(f, ".json"), resource)
    files = sort(list(files))
    return files</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.sos_json.utils.validateEcrrTool">
<code class="highlight language-python">validateEcrrTool(jsonData)</code>
<a class="headerlink" href="#ec.sos_json.utils.validateEcrrTool" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>validated
 Parameters:
     jsonData: jsonld string returns the string
     form: 'compact'--compact form,
            'frome'--framed usngin schemaType,
            'jsonld' - passed form
     schemaType: type of the schema default="Dataset"
 Returns:
     bool.</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sos_json/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def validateEcrrTool(jsonData : str) -&gt; bool:
    """
       validated
        Parameters:
            jsonData: jsonld string returns the string
            form: 'compact'--compact form,
                   'frome'--framed usngin schemaType,
                   'jsonld' - passed form
            schemaType: type of the schema default="Dataset"
        Returns:
            bool.

    """
    try:
        json_data = json.loads(jsonData)
    except ValueError as err:
        return False
    valid2_schema, err = validateJson2Schema(jsonData, schemaname="GeoCodes-ECRR-DatasetSchema.json")
    return valid2_schema</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.sos_json.utils.validateJson2Schema">
<code class="highlight language-python">validateJson2Schema(json_data, schemaname='GeoCodes-DatasetSchema')</code>
<a class="headerlink" href="#ec.sos_json.utils.validateJson2Schema" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>REF: https://json-schema.org/</p>
<p><span class="doc-section-title">Parameters:</span></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>json_data</code></td>
<td>
<code><span title="typing.Any">Any</span></code>
</td>
<td>
<div class="doc-md-description">
<p>JSON Object (aka json.loads())</p>
</div>
</td>
<td>
<em>required</em>
</td>
</tr>
<tr class="doc-section-item">
<td><code>schemaname</code></td>
<td>
</td>
<td>
<div class="doc-md-description">
<p>name of schem in ec.sos_json.shcemas: (GeoCodes-DatasetSchema or GeoCodes-ECRR-DatasetSchema.json)</p>
</div>
</td>
<td>
<code>'GeoCodes-DatasetSchema'</code>
</td>
</tr>
</tbody>
</table>
<p><span class="doc-section-title">Returns:</span></p>
<table>
<thead>
<tr>
<th>Name</th> <th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="doc-section-item">
<td><code>bool</code></td> <td>
<code>bool</code>
</td>
<td>
<div class="doc-md-description">
<p>is valid</p>
</div>
</td>
</tr>
<tr class="doc-section-item">
<td><code>message</code></td> <td>
<code>str</code>
</td>
<td>
<div class="doc-md-description">
<p>"Given JSON data is Valid" or "Given JSON data is InValid"</p>
</div>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sos_json/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def validateJson2Schema(json_data: Any, schemaname='GeoCodes-DatasetSchema') -&gt; Tuple[bool,str]:
    """REF: https://json-schema.org/

    Parameters:
        json_data: JSON Object (aka json.loads())
        schemaname: name of schem in ec.sos_json.shcemas: (GeoCodes-DatasetSchema or GeoCodes-ECRR-DatasetSchema.json)

    Returns:
        bool: is valid
        message: "Given JSON data is Valid" or "Given JSON data is InValid"
        """
    # Describe what kind of json you expect.
    execute_api_schema = _getSchemaFromResources(schemaname)

    try:
        validate(instance=json_data, schema=execute_api_schema)
    except ValidationError as err:
        logging.error(err)
        err = f"Given JSON data is InValid {err}"
        return False, err

    message = "Given JSON data is Valid"
    return True, message</code></pre>
</details>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.sos_json.utils.validateSosDataset">
<code class="highlight language-python">validateSosDataset(jsonData)</code>
<a class="headerlink" href="#ec.sos_json.utils.validateSosDataset" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>validates a SOS Dataset</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/sos_json/utils.py</code></summary>
<pre class="highlight"><code class="language-python">def validateSosDataset(jsonData: str) -&gt; bool:
    """ validates a SOS Dataset"""
    try:
        json_data = json.loads(jsonData)
    except ValueError as err:
        return False
    valid2_schema, err = validateJson2Schema(jsonData)
    return valid2_schema</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.summarize">
<code>summarize</code>
<a class="headerlink" href="#ec.summarize" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-module">
<h3 class="doc doc-heading" id="ec.summarize.summarize_materializedview">
<code>summarize_materializedview</code>
<a class="headerlink" href="#ec.summarize.summarize_materializedview" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-attribute">
<h4 class="doc doc-heading" id="ec.summarize.summarize_materializedview.context">
<code class="highlight language-python">context = f'@prefix : &lt;{BASE_SHCEMA_ORG}&gt; .'</code>
<span class="doc doc-labels">
<small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
</span>
<a class="headerlink" href="#ec.summarize.summarize_materializedview.context" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>original fetch all from temporary namespace</p>
</div>
</div>
<div class="doc doc-object doc-function">
<h4 class="doc doc-heading" id="ec.summarize.summarize_materializedview.summaryDF2ttl">
<code class="highlight language-python">summaryDF2ttl(df, repo, from_release=False)</code>
<a class="headerlink" href="#ec.summarize.summarize_materializedview.summaryDF2ttl" title="Permanent link"></a></h4>
<div class="doc doc-contents">
<p>summarize sparql query returns turtle string and rdf lib Graph</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/summarize/summarize_materializedview.py</code></summary>
<pre class="highlight"><code class="language-python">def summaryDF2ttl(df: pandas.DataFrame, repo: str, from_release=False) -&gt; tuple[ Union[str,bytes], Graph]:
    "summarize sparql query returns turtle string and rdf lib Graph"
    urns = {}
    def is_str(v):
        return type(v) is str
    g = Graph()
    ## ##########
    # Not officially a standard schema format.
    # we might want to use our own namespace in the future
    ###########
    g.bind("ecsummary", BASE_SHCEMA_ORG)
    ecsummary = Namespace(BASE_SHCEMA_ORG)
    sosschema = Namespace(BASE_SHCEMA_ORG)

    for index, row in df.iterrows():
        logging.debug(f'dbg:{row}')
        gu=row["g"]

        graph_subject = URIRef(gu)
        #skip the small %of dups, that even new get_summary.txt * has
        if not urns.get(gu):
            urns[gu]=1
        else:
            #print(f'already:{there},so would break loop')
            continue #from loop


        rt_=row.get('resourceType')
        rt=rt_.replace("https://schema.org/","")
        logging.debug(f'rt:{rt}')

        name=json.dumps(row.get('name')) #check for NaN/fix
        if not name:
            name=f'""'
        if not is_str(name):
            name=f'"{name}"'
        if name=="NaN": #this works, but might use NA
            name=f'"{name}"'
# description
        description=row['description']
        if is_str(description):
            sdes=json.dumps(description)
            #sdes=description.replace(' / ',' \/ ').replace('"','\"')
            #sdes=sdes.replace(' / ',' \/ ').replace('"','\"')
          # sdes=sdes.replace('"','\"')
        else:
            sdes=f'"{description}"'
# keywords
        kw_=row['kw']
        if is_str(kw_):
            kw=json.dumps(kw_)
        else:
            kw=f'"{kw_}"'
# publisher
        pubname=row['pubname']
        if   pandas.isna(pubname) or  pubname=="No Publisher":
            pubname = repo
        #if no publisher urn.split(':')
        #to use:repo in: ['urn', 'gleaner', 'summoned', 'opentopography', '58048498c7c26c7ab253519efc16df237866e8fe']
        #as of the last runs, this was being done per repo, which comes in on the CLI, so could just use that too*


# date
        datep=row['datep']
        if datep == "No datePublished":
            datep=pandas.NA
        # Query should not return "No datePublished" is not a valid Date "YYYY-MM-DD" so
        # UI Date Select failed, because it expects an actual date
        #   Empty values might be handled in the UI...,
        #   or the repository valiation reporting


        placename=row['placenames']


        ##############
        # output
        # write to f StringIO()
        # for RDF graph, using sub, verp object
        ###############
        s=row['subj']
# RDF.TYPE

#         if rt == "tool":
#             g.add((graph_subject,RDF.type, sosschema.SoftwareApplication) )
#         else:
#             g.add((graph_subject, RDF.type, sosschema.Dataset))

        # original aummary query wrote out strings, then converted back to schema uri... just skip that step
        # RDF.TYPE
        rt = row['sosType']
        g.add((graph_subject, RDF.type, URIRef(rt)))

# ecsummary.name
        if (pandas.isnull( row.get('name'))):
            g.add((graph_subject, ecsummary.name, Literal("")))
        else:
            g.add( (graph_subject, ecsummary.name, Literal( row.get('name') ) ) )

# ecsummary.description
        g.add((graph_subject, ecsummary.description, Literal(description)))

# ecsummary.keywords
        g.add((graph_subject, ecsummary.keywords, Literal(kw_)))
# ecsummary.publisher
        if pandas.notna(pubname):
            g.add((graph_subject, ecsummary.publisher, Literal(pubname)))
# ecsummary.place
        g.add((graph_subject, ecsummary.place, Literal(placename)))
# ecsummary date
        if pandas.notna(datep):
            #might be: "No datePublished" ;should change in qry, for dv's lack of checking
            # Query should not return "No datePublished" is not a valid Date "YYYY-MM-DD" so
            # UI Date Select failed, because it expects an actual date
            #   Empty values might be handled in the UI...,
            #   or the repository valiation reporting
            g.add((graph_subject, ecsummary.date, Literal(datep)))
# ecsummary subjectOf
        g.add((graph_subject, ecsummary.subjectOf, URIRef(s)))

# ecsummary.distribution
        du= row.get('url') # check now/not yet
        if is_str(du):
            g.add((graph_subject, ecsummary.distribution, URIRef(s)))
# spatial

# ecsummary.latitude
        mlat= row.get('maxlat') # check now/not yet
        if is_str(mlat):
            g.add((graph_subject, ecsummary.latitude, Literal(mlat)))
        mlon= row.get('maxlon') # check now/not yet
        if is_str(mlon):
            g.add((graph_subject, ecsummary.longitude, Literal(mlon)))

# ecsummary.encodingFormat
        encodingFormat= row.get('encodingFormat') # check now/not yet
        if is_str(encodingFormat):
            g.add((graph_subject, ecsummary.encodingFormat, Literal(encodingFormat)))
        #see abt defaults from qry or here, think dv needs date as NA or blank/check
        #old:
        #got a bad:         :subjectOf &lt;metadata-doi:10.17882/42182&gt; .
        #incl original subj, just in case for now
        #lat/lon not in present ui, but in earlier version

        #### end for ####
    return g.serialize(format='longturtle'), g</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.summarize_from_graph_namespace">
<code>summarize_from_graph_namespace</code>
<a class="headerlink" href="#ec.summarize_from_graph_namespace" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ec.summarize_from_graph_namespace.summarizeGraphOnly">
<code class="highlight language-python">summarizeGraphOnly()</code>
<a class="headerlink" href="#ec.summarize_from_graph_namespace.summarizeGraphOnly" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Summarize directly from a namespace, upload to provided summarize namespace</p>
<details class="description" open="">
<summary>Description</summary>
<ul>
<li>
<p>query for repository graphs using defined repo parameter,</p>
</li>
<li>
<p>build summary triples</p>
</li>
<li>
<p>loading to a summarized namespace</p>
</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/summarize_from_graph_namespace.py</code></summary>
<pre class="highlight"><code class="language-python">def summarizeGraphOnly():
    """ Summarize directly from a namespace, upload to provided summarize namespace

    Description:
        * query for repository graphs using defined repo parameter,

        * build summary triples

        * loading to a summarized namespace

    """
    parser = argparse.ArgumentParser()

    parser.add_argument("--repo", dest='repo', help='repo name used in the  urn')

    parser.add_argument('--graphendpoint', dest='graphendpoint',
                        help='graph endpoint with namespace',
                        default="https://graph.geocodes-dev.earthcube.org/blazegraph/namespace/earthcube/sparql"
                        , required=True)

    parser.add_argument('--nographsummary', action='store_true', dest='nographsummary',
                        help='send triples to file', default=False)
    parser.add_argument('--summary_namespace', dest='summary_namespace',
                        help='summary_namespace  just the namspace. defaults to "repo_summary"',
                        )
    args = parser.parse_args()
    repo = args.repo

    if args.summary_namespace:
        if isValidURL(args.summary_namespace):
            msg = 'For summary_namespace, Please enter the namespace only.'
            print(msg)
            logging.error(msg)
            return 1
        summary = args.summary_namespace
    else:
        summary = f"{repo}_summary"

    endpoint= args.graphendpoint
    graphendpoint = mg.graphFromEndpoint(endpoint)

    try:

        sumnsgraph = mg(graphendpoint, summary)

        summaryendpoint =endpointUpdateNamespace(endpoint,summary)

        if repo is not None:
            summarydf = get_summary4repoSubset(endpoint, repo)
        else:
            # this really needs to be paged ;)
            summarydf = get_summary4graph(endpoint)
            repo = ""

        nt,g = summaryDF2ttl(summarydf,repo) # let's try the new generator

        summaryttl = g.serialize(format='longturtle')
        # write to s3  in future
        # with open(os.path.join("output",f"{repo}.ttl"), 'w') as f:
        #      f.write(summaryttl)
        if not args.nographsummary:
            inserted = sumnsgraph.insert(bytes(summaryttl, 'utf-8'),content_type="application/x-turtle" )
            if inserted:
                logging.info(f"Inserted into graph store{sumnsgraph.namespace}" )
            else:
                logging.error(f" dumping file {repo}.ttl  Repo {repo} not inserted into {sumnsgraph.namespace}")
                dumpToFile(repo, summaryttl)
                return 1
        else:
            logging.info(f" dumping file {repo}.ttl  nographsummary: {args.nographsummary} ")

            dumpToFile(repo, summaryttl)
    except Exception as ex:
        logging.error(f"error {ex}")
        print(f"Error: {ex}")
        return 1</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.summarize_identifier_metadata">
<code>summarize_identifier_metadata</code>
<a class="headerlink" href="#ec.summarize_identifier_metadata" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ec.summarize_identifier_metadata.start">
<code class="highlight language-python">start()</code>
<a class="headerlink" href="#ec.summarize_identifier_metadata.start" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Run the summarize_identifier_metadata program.
Get a list of active repositories from the gleaner file.
For each repository, summarize identifierTypes and matchedPath, then write these information to a file and upload it to s3.
Arguments:
    args: Arguments passed from the command line.
Returns:
    An exit code.</p>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/summarize_identifier_metadata.py</code></summary>
<pre class="highlight"><code class="language-python">def start():
    """
        Run the summarize_identifier_metadata program.
        Get a list of active repositories from the gleaner file.
        For each repository, summarize identifierTypes and matchedPath, then write these information to a file and upload it to s3.
        Arguments:
            args: Arguments passed from the command line.
        Returns:
            An exit code.
    """
    parser = argparse.ArgumentParser()
    # source of sources, and default s3 store.
    #   at present, graph endpoint is no longer in gleaner
    parser.add_argument('--cfgfile', dest='cfgfile',
                        help='gleaner config file')
    # no default for s3 parameters here. read from gleaner. if provided, these override the gleaner config
    parser.add_argument('--s3', dest='s3server',
                        help='s3 server address ')
    parser.add_argument('--s3bucket', dest='s3bucket',
                        help='s3 bucket ')
    parser.add_argument('--no_upload', dest='no_upload', action='store_true', default=False,
                        help='do not upload to s3 bucket ')
    parser.add_argument('--output', default='identifier_metadata_summary.csv',
                        dest='output', help='dump to file')
    parser.add_argument('--json', dest='json', action='store_false', default=True,
                        help='output json format')
    parser.add_argument('--source', action='append', help="one or more repositories (--source a --source b)")

    args = parser.parse_args()
    exitcode = summarizeIdentifierMetadata(args)
    sys.exit(exitcode)</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-module">
<h2 class="doc doc-heading" id="ec.summarize_repo">
<code>summarize_repo</code>
<a class="headerlink" href="#ec.summarize_repo" title="Permanent link"></a></h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-function">
<h3 class="doc doc-heading" id="ec.summarize_repo.summarizeRepo">
<code class="highlight language-python">summarizeRepo()</code>
<a class="headerlink" href="#ec.summarize_repo.summarizeRepo" title="Permanent link"></a></h3>
<div class="doc doc-contents">
<p>Summarize a repository using a temporary graph namespace</p>
<details class="description" open="">
<summary>Description</summary>
<ul>
<li>
<p>read nabu config,</p>
</li>
<li>
<p>uploading to a graph namespace</p>
</li>
<li>
<p>building summarize triples</p>
</li>
<li>
<p>loading to a summarized namespace</p>
</li>
</ul>
</details>
<details class="quote">
<summary>Source code in <code>earthcube_utilities/src/ec/summarize_repo.py</code></summary>
<pre class="highlight"><code class="language-python">def summarizeRepo():
    """ Summarize a repository using a temporary graph namespace

    Description:
        * read nabu config,

        * uploading to a graph namespace

        * building summarize triples

        * loading to a summarized namespace

    """
    parser = argparse.ArgumentParser()

    parser.add_argument("repo", help='repository name')
    parser.add_argument('nabufile', type=argparse.FileType('r'),
                        help='nabu configuration file')
    parser.add_argument('--graphendpoint', dest='graphendpoint',
                        help='use this endpoint (full url:https://graph.geocodes-dev.earthcube.org/blazegraph/namespace/earthcube/sparql"). overrides nabu endpoint')
    parser.add_argument('--glcon', dest='glcon',
                        help='override path to glcon', default="~/indexing/glcon")
    parser.add_argument('--nographsummary', action='store_true', dest='nographsummary',
                        help='send triples to file', default=False)
    parser.add_argument('--keeptemp', dest='graphtemp',
                        help='do not delete the temp namespace. a namespace "{repo}_temp" will be created', default=True)
    parser.add_argument('--summary_namespace', dest='summary_namespace',
                        help='summary_namespace. just the namepsace defaults to "{repo}_temp_summary"')
    args = parser.parse_args()

    repo = args.repo
    if args.summary_namespace:
        if isValidURL(args.summary_namespace):
            msg = 'For summary_namespace, Please enter the namespace only.'
            print(msg)
            logging.error(msg)
            return 1
        summary = args.summary_namespace
    else:
        summary = f"{repo}__temp_summary"
    nabucfg = args.nabufile
    endpoint, cfg = getNabuFromFile(nabucfg)
    graphendpoint = mg.graphFromEndpoint(endpoint)
    tempnsgraph = mg(graphendpoint, f'{repo}_temp')
    try:  # temp has been created
        created = tempnsgraph.createNamespace()
        if ( created=='Failed'):
            logging.fatal("coould not create namespace")
        sumnsgraph = mg(graphendpoint, summary)
        created = sumnsgraph.createNamespace()
        if ( created=='Failed'):
            logging.fatal("coould not create summary namespace")
        # endpoints for file
        tempendpoint =endpointUpdateNamespace(endpoint,f"{repo}_temp")
        summaryendpoint =endpointUpdateNamespace(endpoint,summary)
        newNabucfg = reviseNabuConfGraph(cfg, tempendpoint)
        runNabu(newNabucfg,repo, args.glcon )

        summarydf = get_summary4repo(tempendpoint)
        nt,g = summaryDF2ttl(summarydf,repo) # let's try the new generator
        summaryttl = g.serialize(format='longturtle')
        # write to s3  in future
        dumpToFile(repo, summaryttl)
        if not args.nographsummary:
            inserted = sumnsgraph.insert(bytes(summaryttl, 'utf-8'),content_type="application/x-turtle" )
            if inserted:
                logging.info(f"Inserted into graph store{sumnsgraph.namespace}" )
            else:
                logging.error(f" dumping file {repo}_dumped.ttl  Repo {repo} not inserted into {sumnsgraph.namespace}")
                dumpToFile(f"{repo}_dumped", summaryttl)
                return 1
    except Exception as ex:
        logging.error(f"error {ex}")
        print(f"Error: {ex}")
        return 1
    finally:
        # need to figure out is this is run after return, I think it is.
        if not args.graphtemp :
            logging.debug(f"Deleting Temp namespace {tempnsgraph.namespace}")
            deleted = tempnsgraph.deleteNamespace()
        return 0</code></pre>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.action.view", "content.action.edit", "content.code.annotate", "navigation.sections", "navigation.tabs", "navigation.path"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.525ec568.min.js"></script>
<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</body>
</html>