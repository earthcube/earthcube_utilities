
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../reporting/" rel="prev"/>
<link href="../earthcube_utilities_code/" rel="next"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.40" name="generator"/>
<title>Summarize - Earthcube Utilities</title>
<link href="../../assets/stylesheets/main.8c3ca2c6.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../assets/_mkdocstrings.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#summarize">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Earthcube Utilities" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Earthcube Utilities">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Earthcube Utilities
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Summarize
            
          </span>
</div>
</div>
</div>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/earthcube/earthcube_utilities" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../notebook_proxy/">
        
  
    
  
  Notebook Proxy

      </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../">
          
  
  Earthcube Utilities

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../earthcube_utilities_code/">
          
  
  Code Reference

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Earthcube Utilities" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Earthcube Utilities">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    Earthcube Utilities
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/earthcube/earthcube_utilities" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../notebook_proxy/">
<span class="md-ellipsis">
    Notebook Proxy
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
<span class="md-ellipsis">
    Earthcube Utilities
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Earthcube Utilities
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Documentation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../earthcube_utilities_scripts/">
<span class="md-ellipsis">
    Scripts
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../reporting/">
<span class="md-ellipsis">
    Reporting
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Summarize
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Summarize
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
<span class="md-ellipsis">
      Overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#workflow-for-summarize-a-part-of-qualifying-a-repostiory-for-loading-into-geocodes">
<span class="md-ellipsis">
      workflow for Summarize a part of qualifying a repostiory for loading into geocodes
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#workflow-for-summarizing-from-an-existing-graph-namespace">
<span class="md-ellipsis">
      Workflow for Summarizing from an existing graph namespace
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dependencies">
<span class="md-ellipsis">
      Dependencies
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#install">
<span class="md-ellipsis">
      INSTALL
    </span>
</a>
<nav aria-label="INSTALL" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#option-1-doing-developement">
<span class="md-ellipsis">
      option 1: doing developement
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#option-2-use-package">
<span class="md-ellipsis">
      Option 2: use package
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#approaches">
<span class="md-ellipsis">
      Approaches
    </span>
</a>
<nav aria-label="Approaches" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#summarize-an-existing-graph-stores">
<span class="md-ellipsis">
      Summarize an existing graph stores.
    </span>
</a>
<nav aria-label="Summarize an existing graph stores." class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#run-summarize_from_graph_namespace">
<span class="md-ellipsis">
      run summarize_from_graph_namespace
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#summarize-a-part-of-qualifying-a-repostiory-for-loading-into-geocodes">
<span class="md-ellipsis">
      Summarize a part of qualifying a repostiory for loading into geocodes
    </span>
</a>
<nav aria-label="Summarize a part of qualifying a repostiory for loading into geocodes" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#run-summarize_repo">
<span class="md-ellipsis">
      run summarize_repo
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#developement">
<span class="md-ellipsis">
      Developement
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Code Reference
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../earthcube_utilities_code/">
<span class="md-ellipsis">
    Earthcube Utilites
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
<span class="md-ellipsis">
      Overview
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#workflow-for-summarize-a-part-of-qualifying-a-repostiory-for-loading-into-geocodes">
<span class="md-ellipsis">
      workflow for Summarize a part of qualifying a repostiory for loading into geocodes
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#workflow-for-summarizing-from-an-existing-graph-namespace">
<span class="md-ellipsis">
      Workflow for Summarizing from an existing graph namespace
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dependencies">
<span class="md-ellipsis">
      Dependencies
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#install">
<span class="md-ellipsis">
      INSTALL
    </span>
</a>
<nav aria-label="INSTALL" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#option-1-doing-developement">
<span class="md-ellipsis">
      option 1: doing developement
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#option-2-use-package">
<span class="md-ellipsis">
      Option 2: use package
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#approaches">
<span class="md-ellipsis">
      Approaches
    </span>
</a>
<nav aria-label="Approaches" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#summarize-an-existing-graph-stores">
<span class="md-ellipsis">
      Summarize an existing graph stores.
    </span>
</a>
<nav aria-label="Summarize an existing graph stores." class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#run-summarize_from_graph_namespace">
<span class="md-ellipsis">
      run summarize_from_graph_namespace
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#summarize-a-part-of-qualifying-a-repostiory-for-loading-into-geocodes">
<span class="md-ellipsis">
      Summarize a part of qualifying a repostiory for loading into geocodes
    </span>
</a>
<nav aria-label="Summarize a part of qualifying a repostiory for loading into geocodes" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#run-summarize_repo">
<span class="md-ellipsis">
      run summarize_repo
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#developement">
<span class="md-ellipsis">
      Developement
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/earthcube/earthcube_utilities/edit/docs/docs/earthcube_utilities/summarize.md" title="Edit this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg>
</a>
<a class="md-content__button md-icon" href="https://github.com/earthcube/earthcube_utilities/raw/docs/docs/earthcube_utilities/summarize.md" title="View source of this page">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"></path></svg>
</a>
<h1 id="summarize">Summarize<a class="headerlink" href="#summarize" title="Permanent link"></a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link"></a></h2>
<p>Because of the lack of standardardization on how Science on Schema is implemented, there are performance issues
quering and retrieving information from the blazegraph graphstore. Because JSONLD fields can be strings/objects/arrays
asking the graphstore to guess the best optimization for retrieval is haphazard.
In order to work around this, we create a materilized view view. Materialization is common performance trick
which basically brings all values into a single object so that retreival of what would be normalized
information is flattened.  The JSONLD strings/objects/arrays single object to improve search and retrieval performance. </p>
<p><strong>Summarize tools</strong> create a 'materialized" view of a repositories JSONLD as triple to improve
performance a searches for geocodes. </p>
<p>To do this, it reads the named graphs (aka quads) that nabu generates as part of its workflow, then 
converts them into flattend triples in  'summary' graph namespace.</p>
<h2 id="workflow-for-summarize-a-part-of-qualifying-a-repostiory-for-loading-into-geocodes">workflow for  Summarize a part of qualifying a repostiory for loading into geocodes<a class="headerlink" href="#workflow-for-summarize-a-part-of-qualifying-a-repostiory-for-loading-into-geocodes" title="Permanent link"></a></h2>
<pre class="mermaid"><code>sequenceDiagram

    participant summarize_repo.py
    participant manageGraph
    participant nabu
    participant summarize_materializedview.py
    participant graphstore


    summarize_repo.py-&gt;&gt;summarize_repo.py: load nabu configuration file 
    summarize_repo.py-&gt;&gt;manageGraph: call to create managegraph instance for repo_temp 
    summarize_repo.py-&gt;&gt;manageGraph: call to create namespace for repo_temp 
    manageGraph-&gt;&gt;graphstore: creates namespace  for repo_temp

    summarize_repo.py-&gt;&gt;manageGraph: call to create managegraph instance for repo_summary 
    summarize_repo.py-&gt;&gt;manageGraph: call to create namespace for repo_summary

    manageGraph-&gt;&gt;graphstore: creates namespace  for repo_summary, if it does not exist
    summarize_repo.py-&gt;&gt;summarize_repo.py: create nabu config to load to temp  
    summarize_repo.py-&gt;&gt;nabu:  execute nabu with modified config file
    nabu-&gt;&gt;nabu:  reads configuration, files from s3, converts to quads 
    nabu-&gt;&gt;graphstore:  writes quads to repo_temp namespace
    summarize_repo.py-&gt;&gt;summarize_materializedview.py: call materialize summary
    graphstore-&gt;&gt;summarize_materializedview.py: query temp namespace in graph store
    summarize_materializedview.py-&gt;&gt;summarize_materializedview.py: create summary triples
    summarize_materializedview.py-&gt;&gt;summarize_repo.py: return summary triples
    summarize_repo.py-&gt;&gt;manageGraph: if graphsummary:  insert summary triples as byte[] to blazegraph
    manageGraph-&gt;&gt;graphstore: insert ttl to repo_summary namespace
    summarize_repo.py-&gt;&gt;summarize_repo.py: if not graphsummary: write file repo.ttl
    summarize_repo.py-&gt;&gt;manageGraph: delete repo_temp namespace

</code></pre>
<h2 id="workflow-for-summarizing-from-an-existing-graph-namespace">Workflow for Summarizing from an existing graph namespace<a class="headerlink" href="#workflow-for-summarizing-from-an-existing-graph-namespace" title="Permanent link"></a></h2>
<pre class="mermaid"><code>sequenceDiagram

    participant summarize_from_graph_names.py
    participant manageGraph
    participant summarize_materializedview.py
    participant graphstore


    summarize_from_graph_names.py-&gt;&gt;summarize_from_graph_names.py: load nabu configuration file 

    summarize_from_graph_names.py-&gt;&gt;summarize_materializedview.py: call materialize summary
    graphstore-&gt;&gt;summarize_materializedview.py: query  namespace in graph store
    summarize_materializedview.py-&gt;&gt;summarize_materializedview.py: create summary triples
    summarize_materializedview.py-&gt;&gt;summarize_from_graph_names.py: return summary triples
    summarize_from_graph_names.py-&gt;&gt;manageGraph: if graphsummary:  insert summary triples as byte[] to blazegraph
    manageGraph-&gt;&gt;graphstore: insert ttl to repo_summary namespace
    summarize_from_graph_names.py-&gt;&gt;summarize_from_graph_names.py: if not graphsummary: write file repo.ttl


</code></pre>
<h2 id="dependencies">Dependencies<a class="headerlink" href="#dependencies" title="Permanent link"></a></h2>
<ul>
<li>Geocodes Stack</li>
<li>glcon</li>
<li>python &gt; 3.3</li>
<li>the nabu configuration file that was used to load the data to the graphstore</li>
</ul>
<h2 id="install">INSTALL<a class="headerlink" href="#install" title="Permanent link"></a></h2>
<h3 id="option-1-doing-developement">option 1: doing developement<a class="headerlink" href="#option-1-doing-developement" title="Permanent link"></a></h3>
<ul>
<li>pull repository,<ul>
<li><code>git clone https://github.com/earthcube/earthcube_utilities.git</code></li>
</ul>
</li>
<li><code>cd earthcube_utilities/summarize</code></li>
<li>install python dependencies<ul>
<li><code>pip3 install requirements.txt</code></li>
</ul>
</li>
<li>Run steps below</li>
</ul>
<h3 id="option-2-use-package">Option 2: use package<a class="headerlink" href="#option-2-use-package" title="Permanent link"></a></h3>
<p>The code exists in a testing package
<code>python3 -m pip install --index-url https://test.pypi.org/simple/ earthcube_summarize</code></p>
<h2 id="approaches">Approaches<a class="headerlink" href="#approaches" title="Permanent link"></a></h2>
<ul>
<li>Summarize existing graph stores. AKA: data is loaded into a graph. The can and should be subsetted using  a repository name.</li>
<li>Summarize as part of workflow, aka build summary when repo is loaded. 
  This is useful for onboarding a new repository
   it loaded from s3 to a grpah using <code>glcon nabu</code> into a temporary repository, 
  queries, then pushes results to a summary namespace</li>
<li>Build summary for a 'release' graph (coded, but untested/undocumented)</li>
</ul>
<h3 id="summarize-an-existing-graph-stores">Summarize an existing graph stores.<a class="headerlink" href="#summarize-an-existing-graph-stores" title="Permanent link"></a></h3>
<p>This can  summarize an entire graph store, or just process a msubset, eg, a recently updated repo.</p>
<ul>
<li>The information is in an existing blazegraph instance <ul>
<li><code>glcon nabu prefix --cfgName {configdir}</code> </li>
</ul>
</li>
<li>There exists a  summary namespace in a blazegraph instance</li>
</ul>
<pre class="highlight"><code class="language-text">usage: summarize_from_graph_namespace.py [-h] [--repo REPO] --graphendpoint GRAPHENDPOINT [--graphsummary GRAPHSUMMARY] [--summary_namespace SUMMARY_NAMESPACE]

optional arguments:
  -h, --help            show this help message and exit
  --repo REPO           repo name used in the urn
  --graphendpoint GRAPHENDPOINT
                        graph endpoint with namespace
  --graphsummary GRAPHSUMMARY
                        upload triples to graphsummary
  --summary_namespace SUMMARY_NAMESPACE
                        summary_namespace defaults to {repo_summary}
</code></pre>
<h4 id="run-summarize_from_graph_namespace">run summarize_from_graph_namespace<a class="headerlink" href="#run-summarize_from_graph_namespace" title="Permanent link"></a></h4>
<ol>
<li>if you have not, changed to the summarize directory: <code>cd  earthcube_utilities/summarize</code></li>
<li>run</li>
</ol>
<p><strong>option 2 script installed</strong>
<pre class="highlight"><code class="language-shell">summarize_from_graph --repo {repo} --graphendpoint {endppiont} --summary_namespace {earthcube_summary}
</code></pre></p>
<p><strong>option1 from repository</strong>
<pre class="highlight"><code class="language-shell">./src/ec_summarize/summarize_from_graph_namespace.py --repo {repo} --graphendpoint {endppiont} --summary_namespace {earthcube_summary}
</code></pre>
repo is optional. Without the  <code>--repo</code> the code will summarize all information</p>
<h3 id="summarize-a-part-of-qualifying-a-repostiory-for-loading-into-geocodes">Summarize a part of qualifying a repostiory for loading into geocodes<a class="headerlink" href="#summarize-a-part-of-qualifying-a-repostiory-for-loading-into-geocodes" title="Permanent link"></a></h3>
<p>As part of the qualifying of a repository for loading we want to load the data into separate instances
This codebase will read a gleaner configuraiton, push the summoned information to a repository, and create a
summary repository</p>
<pre class="highlight"><code class="language-text">usage: summarize_repo.py [-h] [--graphendpoint GRAPHENDPOINT] [--glcon GLCON] [--graphsummary GRAPHSUMMARY] [--keeptemp GRAPHTEMP]
                         [--summary_namespace SUMMARY_NAMESPACE]
                         repo nabufile

positional arguments:
  repo                  repository name
  nabufile              nabu configuration file

optional arguments:
  -h, --help            show this help message and exit
  --graphendpoint GRAPHENDPOINT
                        override nabu endpoint
  --glcon GLCON         override path to glcon
  --graphsummary GRAPHSUMMARY
                        upload triples to graphsummary
  --keeptemp GRAPHTEMP  do not delete the temp namespace. a namespace {repo}_temp will be created
  --summary_namespace SUMMARY_NAMESPACE
                        summary_namespace defaults to {repo}_temp_summary
</code></pre>
<h4 id="run-summarize_repo">run summarize_repo<a class="headerlink" href="#run-summarize_repo" title="Permanent link"></a></h4>
<p><strong>option 2 script installed</strong>
<pre class="highlight"><code class="language-shell">summarize_from_repo {repo} {path_to_nabu_config_file} --graphendpoint {endppiont} --summary_namespace {{repo}_temp_summary}
</code></pre></p>
<p><strong>option1 from repository</strong>
<pre class="highlight"><code class="language-shell">./src/ec_summarize/summarize_repo.py {repo} {path_to_nabu_config_file} --graphendpoint {endppiont} --summary_namespace {{repo}_temp_summary}
</code></pre></p>
<h2 id="developement">Developement<a class="headerlink" href="#developement" title="Permanent link"></a></h2>
<p>create a virutal env</p>
<p><code>source {envname}/bin/activate</code></p>
<p>use editable install</p>
<pre class="highlight"><code class="language-shell">cd summarize
pip3 install -e .</code></pre>
<p>If you edit the pyproject.toml and want to test an added script, 
<pre class="highlight"><code class="language-shell">cd summarize
pip3 uninstall -e earthcube-summarize
pip3 install -e .</code></pre></p>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.action.view", "content.action.edit", "content.code.annotate", "navigation.sections", "navigation.tabs", "navigation.path"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.525ec568.min.js"></script>
<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
<script>window.mermaidConfig = {default: {
    startOnLoad: false
}};</script></body>
</html>